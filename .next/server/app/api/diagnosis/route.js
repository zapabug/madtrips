/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/diagnosis/route";
exports.ids = ["app/api/diagnosis/route"];
exports.modules = {

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fdiagnosis%2Froute&page=%2Fapi%2Fdiagnosis%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fdiagnosis%2Froute.ts&appDir=%2Fhome%2Flfg%2FGit%2FMadtrips%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Flfg%2FGit%2FMadtrips&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fdiagnosis%2Froute&page=%2Fapi%2Fdiagnosis%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fdiagnosis%2Froute.ts&appDir=%2Fhome%2Flfg%2FGit%2FMadtrips%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Flfg%2FGit%2FMadtrips&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _home_lfg_Git_Madtrips_src_app_api_diagnosis_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/diagnosis/route.ts */ \"(rsc)/./src/app/api/diagnosis/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/diagnosis/route\",\n        pathname: \"/api/diagnosis\",\n        filename: \"route\",\n        bundlePath: \"app/api/diagnosis/route\"\n    },\n    resolvedPagePath: \"/home/lfg/Git/Madtrips/src/app/api/diagnosis/route.ts\",\n    nextConfigOutput,\n    userland: _home_lfg_Git_Madtrips_src_app_api_diagnosis_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZkaWFnbm9zaXMlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmRpYWdub3NpcyUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmRpYWdub3NpcyUyRnJvdXRlLnRzJmFwcERpcj0lMkZob21lJTJGbGZnJTJGR2l0JTJGTWFkdHJpcHMlMkZzcmMlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRmhvbWUlMkZsZmclMkZHaXQlMkZNYWR0cmlwcyZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBK0Y7QUFDdkM7QUFDcUI7QUFDSztBQUNsRjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IseUdBQW1CO0FBQzNDO0FBQ0EsY0FBYyxrRUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHNEQUFzRDtBQUM5RDtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUMwRjs7QUFFMUYiLCJzb3VyY2VzIjpbIiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL2hvbWUvbGZnL0dpdC9NYWR0cmlwcy9zcmMvYXBwL2FwaS9kaWFnbm9zaXMvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2RpYWdub3Npcy9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2RpYWdub3Npc1wiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvZGlhZ25vc2lzL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL2hvbWUvbGZnL0dpdC9NYWR0cmlwcy9zcmMvYXBwL2FwaS9kaWFnbm9zaXMvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyB3b3JrQXN5bmNTdG9yYWdlLCB3b3JrVW5pdEFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICB3b3JrQXN5bmNTdG9yYWdlLFxuICAgICAgICB3b3JrVW5pdEFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHdvcmtBc3luY1N0b3JhZ2UsIHdvcmtVbml0QXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fdiagnosis%2Froute&page=%2Fapi%2Fdiagnosis%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fdiagnosis%2Froute.ts&appDir=%2Fhome%2Flfg%2FGit%2FMadtrips%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Flfg%2FGit%2FMadtrips&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/app/api/diagnosis/route.ts":
/*!****************************************!*\
  !*** ./src/app/api/diagnosis/route.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _lib_nostr_NostrSocialGraphFetcher__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/nostr/NostrSocialGraphFetcher */ \"(rsc)/./src/lib/nostr/NostrSocialGraphFetcher.ts\");\n\n\n\n\nasync function GET() {\n    try {\n        // Check if data files exist\n        const diagnosticResults = {\n            files: {\n                status: 'checking',\n                details: {}\n            },\n            data: {\n                status: 'checking',\n                details: {}\n            },\n            api: {\n                status: 'checking',\n                details: {}\n            }\n        };\n        // Check data files\n        const dataDir = path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), 'data');\n        const socialGraphPath = path__WEBPACK_IMPORTED_MODULE_1___default().join(dataDir, 'social-graph.json');\n        const knownPubkeysPath = path__WEBPACK_IMPORTED_MODULE_1___default().join(dataDir, 'known-pubkeys.json');\n        // Check if directory exists\n        diagnosticResults.files.details.directoryExists = fs__WEBPACK_IMPORTED_MODULE_2___default().existsSync(dataDir);\n        // Check individual files\n        if (diagnosticResults.files.details.directoryExists) {\n            diagnosticResults.files.details.socialGraphExists = fs__WEBPACK_IMPORTED_MODULE_2___default().existsSync(socialGraphPath);\n            diagnosticResults.files.details.knownPubkeysExists = fs__WEBPACK_IMPORTED_MODULE_2___default().existsSync(knownPubkeysPath);\n            // Check file sizes\n            if (diagnosticResults.files.details.socialGraphExists) {\n                const stats = fs__WEBPACK_IMPORTED_MODULE_2___default().statSync(socialGraphPath);\n                diagnosticResults.files.details.socialGraphSize = stats.size;\n                diagnosticResults.files.details.socialGraphModified = stats.mtime;\n                // Read a sample of the file to check validity\n                try {\n                    const fileContent = fs__WEBPACK_IMPORTED_MODULE_2___default().readFileSync(socialGraphPath, 'utf-8');\n                    const data = JSON.parse(fileContent);\n                    diagnosticResults.files.details.socialGraphValid = true;\n                    diagnosticResults.files.details.nodesCount = data.nodes?.length || 0;\n                    diagnosticResults.files.details.linksCount = data.links?.length || 0;\n                } catch (e) {\n                    diagnosticResults.files.details.socialGraphValid = false;\n                    diagnosticResults.files.details.socialGraphError = e.message;\n                }\n            }\n            if (diagnosticResults.files.details.knownPubkeysExists) {\n                const stats = fs__WEBPACK_IMPORTED_MODULE_2___default().statSync(knownPubkeysPath);\n                diagnosticResults.files.details.knownPubkeysSize = stats.size;\n                diagnosticResults.files.details.knownPubkeysModified = stats.mtime;\n                // Read the file to check validity\n                try {\n                    const fileContent = fs__WEBPACK_IMPORTED_MODULE_2___default().readFileSync(knownPubkeysPath, 'utf-8');\n                    const data = JSON.parse(fileContent);\n                    diagnosticResults.files.details.knownPubkeysValid = true;\n                    diagnosticResults.files.details.pubkeysCount = Object.keys(data.npubs || {}).length;\n                } catch (e) {\n                    diagnosticResults.files.details.knownPubkeysValid = false;\n                    diagnosticResults.files.details.knownPubkeysError = e.message;\n                }\n            }\n        }\n        // Set overall file status\n        if (!diagnosticResults.files.details.directoryExists) {\n            diagnosticResults.files.status = 'error';\n            diagnosticResults.files.message = 'Data directory does not exist';\n        } else if (!diagnosticResults.files.details.socialGraphExists || !diagnosticResults.files.details.knownPubkeysExists) {\n            diagnosticResults.files.status = 'warning';\n            diagnosticResults.files.message = 'One or more data files missing';\n        } else if (!diagnosticResults.files.details.socialGraphValid || !diagnosticResults.files.details.knownPubkeysValid) {\n            diagnosticResults.files.status = 'error';\n            diagnosticResults.files.message = 'One or more data files are invalid';\n        } else {\n            diagnosticResults.files.status = 'success';\n            diagnosticResults.files.message = 'All data files exist and are valid';\n        }\n        // Check data from fetcher\n        try {\n            const graphData = await (0,_lib_nostr_NostrSocialGraphFetcher__WEBPACK_IMPORTED_MODULE_3__.getSocialGraphData)();\n            diagnosticResults.data.details.fetchSuccess = true;\n            diagnosticResults.data.details.hasNodes = Boolean(graphData.nodes && graphData.nodes.length > 0);\n            diagnosticResults.data.details.nodesCount = graphData.nodes?.length || 0;\n            diagnosticResults.data.details.hasLinks = Boolean(graphData.links && graphData.links.length > 0);\n            diagnosticResults.data.details.linksCount = graphData.links?.length || 0;\n            if (diagnosticResults.data.details.nodesCount > 0) {\n                diagnosticResults.data.details.sampleNodes = graphData.nodes.slice(0, 3);\n            }\n            // Check node types distribution\n            const nodeTypes = {};\n            if (graphData.nodes) {\n                graphData.nodes.forEach((node)=>{\n                    const type = node.type || 'unknown';\n                    nodeTypes[type] = (nodeTypes[type] || 0) + 1;\n                });\n                diagnosticResults.data.details.nodeTypeDistribution = nodeTypes;\n            }\n            // Set data status\n            if (!diagnosticResults.data.details.hasNodes) {\n                diagnosticResults.data.status = 'error';\n                diagnosticResults.data.message = 'No nodes found in social graph data';\n            } else if (!diagnosticResults.data.details.hasLinks) {\n                diagnosticResults.data.status = 'warning';\n                diagnosticResults.data.message = 'Nodes found but no links in social graph data';\n            } else {\n                diagnosticResults.data.status = 'success';\n                diagnosticResults.data.message = `Social graph has ${diagnosticResults.data.details.nodesCount} nodes and ${diagnosticResults.data.details.linksCount} links`;\n            }\n        } catch (e) {\n            diagnosticResults.data.status = 'error';\n            diagnosticResults.data.message = `Failed to fetch social graph data: ${e.message}`;\n            diagnosticResults.data.details.fetchSuccess = false;\n            diagnosticResults.data.details.error = e.message;\n        }\n        // Overall API status\n        if (diagnosticResults.files.status === 'error' || diagnosticResults.data.status === 'error') {\n            diagnosticResults.api.status = 'error';\n            diagnosticResults.api.message = 'Critical issues found with social graph data';\n        } else if (diagnosticResults.files.status === 'warning' || diagnosticResults.data.status === 'warning') {\n            diagnosticResults.api.status = 'warning';\n            diagnosticResults.api.message = 'Non-critical issues found with social graph data';\n        } else {\n            diagnosticResults.api.status = 'success';\n            diagnosticResults.api.message = 'Social graph data is healthy';\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            message: 'Diagnosis complete',\n            timestamp: Date.now(),\n            results: diagnosticResults,\n            recommendations: generateRecommendations(diagnosticResults)\n        });\n    } catch (error) {\n        console.error('Diagnosis error:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            message: 'Diagnosis failed',\n            error: error.message,\n            timestamp: Date.now()\n        }, {\n            status: 500\n        });\n    }\n}\nfunction generateRecommendations(results) {\n    const recommendations = [];\n    if (results.files.status !== 'success') {\n        if (!results.files.details.directoryExists) {\n            recommendations.push('Create the data directory at the root of your project');\n        }\n        if (!results.files.details.socialGraphExists) {\n            recommendations.push('Initialize the social-graph.json file with a valid graph structure: {\"nodes\":[],\"links\":[]}');\n        }\n        if (!results.files.details.knownPubkeysExists) {\n            recommendations.push('Initialize the known-pubkeys.json file with a valid structure: {\"npubs\":{}}');\n        }\n        if (results.files.details.socialGraphExists && !results.files.details.socialGraphValid) {\n            recommendations.push('Fix the social-graph.json file - it contains invalid JSON');\n        }\n        if (results.files.details.knownPubkeysExists && !results.files.details.knownPubkeysValid) {\n            recommendations.push('Fix the known-pubkeys.json file - it contains invalid JSON');\n        }\n    }\n    if (results.data.status !== 'success') {\n        if (!results.data.details.fetchSuccess) {\n            recommendations.push('Check the getSocialGraphData function for errors');\n        } else if (!results.data.details.hasNodes) {\n            recommendations.push('The social graph has no nodes. Try updating it with known npubs');\n            recommendations.push('Use the admin UI or API to add initial npubs');\n        } else if (!results.data.details.hasLinks) {\n            recommendations.push('The social graph has nodes but no links. This suggests incomplete data');\n            recommendations.push('Try updating more npubs or checking the link generation logic');\n        }\n    }\n    // Check file sizes\n    if (results.files.details.socialGraphSize && results.files.details.socialGraphSize < 100) {\n        recommendations.push('The social-graph.json file is suspiciously small. It may be empty or initialized incorrectly');\n    }\n    // Add general recommendations\n    recommendations.push('Visit the admin page at /admin/socialgraph to manage the social graph');\n    recommendations.push('If visualization issues persist, check the browser console for client-side errors');\n    return recommendations;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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WUFDdEZtQyxnQkFBZ0JHLElBQUksQ0FBQztRQUN2QjtRQUNBLElBQUlKLFFBQVEzRCxLQUFLLENBQUNFLE9BQU8sQ0FBQ1ksa0JBQWtCLElBQUksQ0FBQzZDLFFBQVEzRCxLQUFLLENBQUNFLE9BQU8sQ0FBQ2tDLGlCQUFpQixFQUFFO1lBQ3hGd0IsZ0JBQWdCRyxJQUFJLENBQUM7UUFDdkI7SUFDRjtJQUVBLElBQUlKLFFBQVF4RCxJQUFJLENBQUNGLE1BQU0sS0FBSyxXQUFXO1FBQ3JDLElBQUksQ0FBQzBELFFBQVF4RCxJQUFJLENBQUNELE9BQU8sQ0FBQ3lDLFlBQVksRUFBRTtZQUN0Q2lCLGdCQUFnQkcsSUFBSSxDQUFDO1FBQ3ZCLE9BQU8sSUFBSSxDQUFDSixRQUFReEQsSUFBSSxDQUFDRCxPQUFPLENBQUMwQyxRQUFRLEVBQUU7WUFDekNnQixnQkFBZ0JHLElBQUksQ0FBQztZQUNyQkgsZ0JBQWdCRyxJQUFJLENBQUM7UUFDdkIsT0FBTyxJQUFJLENBQUNKLFFBQVF4RCxJQUFJLENBQUNELE9BQU8sQ0FBQzRDLFFBQVEsRUFBRTtZQUN6Q2MsZ0JBQWdCRyxJQUFJLENBQUM7WUFDckJILGdCQUFnQkcsSUFBSSxDQUFDO1FBQ3ZCO0lBQ0Y7SUFFQSxtQkFBbUI7SUFDbkIsSUFBSUosUUFBUTNELEtBQUssQ0FBQ0UsT0FBTyxDQUFDZSxlQUFlLElBQUkwQyxRQUFRM0QsS0FBSyxDQUFDRSxPQUFPLENBQUNlLGVBQWUsR0FBRyxLQUFLO1FBQ3hGMkMsZ0JBQWdCRyxJQUFJLENBQUM7SUFDdkI7SUFFQSw4QkFBOEI7SUFDOUJILGdCQUFnQkcsSUFBSSxDQUFDO0lBQ3JCSCxnQkFBZ0JHLElBQUksQ0FBQztJQUVyQixPQUFPSDtBQUNUIiwic291cmNlcyI6WyIvaG9tZS9sZmcvR2l0L01hZHRyaXBzL3NyYy9hcHAvYXBpL2RpYWdub3Npcy9yb3V0ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCBmcyBmcm9tICdmcyc7XG5pbXBvcnQgeyBnZXRTb2NpYWxHcmFwaERhdGEgfSBmcm9tICdAL2xpYi9ub3N0ci9Ob3N0clNvY2lhbEdyYXBoRmV0Y2hlcic7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQoKSB7XG4gIHRyeSB7XG4gICAgLy8gQ2hlY2sgaWYgZGF0YSBmaWxlcyBleGlzdFxuICAgIGNvbnN0IGRpYWdub3N0aWNSZXN1bHRzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge1xuICAgICAgZmlsZXM6IHtcbiAgICAgICAgc3RhdHVzOiAnY2hlY2tpbmcnLFxuICAgICAgICBkZXRhaWxzOiB7fVxuICAgICAgfSxcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgc3RhdHVzOiAnY2hlY2tpbmcnLFxuICAgICAgICBkZXRhaWxzOiB7fVxuICAgICAgfSxcbiAgICAgIGFwaToge1xuICAgICAgICBzdGF0dXM6ICdjaGVja2luZycsXG4gICAgICAgIGRldGFpbHM6IHt9XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8vIENoZWNrIGRhdGEgZmlsZXNcbiAgICBjb25zdCBkYXRhRGlyID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksICdkYXRhJyk7XG4gICAgY29uc3Qgc29jaWFsR3JhcGhQYXRoID0gcGF0aC5qb2luKGRhdGFEaXIsICdzb2NpYWwtZ3JhcGguanNvbicpO1xuICAgIGNvbnN0IGtub3duUHVia2V5c1BhdGggPSBwYXRoLmpvaW4oZGF0YURpciwgJ2tub3duLXB1YmtleXMuanNvbicpO1xuXG4gICAgLy8gQ2hlY2sgaWYgZGlyZWN0b3J5IGV4aXN0c1xuICAgIGRpYWdub3N0aWNSZXN1bHRzLmZpbGVzLmRldGFpbHMuZGlyZWN0b3J5RXhpc3RzID0gZnMuZXhpc3RzU3luYyhkYXRhRGlyKTtcbiAgICBcbiAgICAvLyBDaGVjayBpbmRpdmlkdWFsIGZpbGVzXG4gICAgaWYgKGRpYWdub3N0aWNSZXN1bHRzLmZpbGVzLmRldGFpbHMuZGlyZWN0b3J5RXhpc3RzKSB7XG4gICAgICBkaWFnbm9zdGljUmVzdWx0cy5maWxlcy5kZXRhaWxzLnNvY2lhbEdyYXBoRXhpc3RzID0gZnMuZXhpc3RzU3luYyhzb2NpYWxHcmFwaFBhdGgpO1xuICAgICAgZGlhZ25vc3RpY1Jlc3VsdHMuZmlsZXMuZGV0YWlscy5rbm93blB1YmtleXNFeGlzdHMgPSBmcy5leGlzdHNTeW5jKGtub3duUHVia2V5c1BhdGgpO1xuICAgICAgXG4gICAgICAvLyBDaGVjayBmaWxlIHNpemVzXG4gICAgICBpZiAoZGlhZ25vc3RpY1Jlc3VsdHMuZmlsZXMuZGV0YWlscy5zb2NpYWxHcmFwaEV4aXN0cykge1xuICAgICAgICBjb25zdCBzdGF0cyA9IGZzLnN0YXRTeW5jKHNvY2lhbEdyYXBoUGF0aCk7XG4gICAgICAgIGRpYWdub3N0aWNSZXN1bHRzLmZpbGVzLmRldGFpbHMuc29jaWFsR3JhcGhTaXplID0gc3RhdHMuc2l6ZTtcbiAgICAgICAgZGlhZ25vc3RpY1Jlc3VsdHMuZmlsZXMuZGV0YWlscy5zb2NpYWxHcmFwaE1vZGlmaWVkID0gc3RhdHMubXRpbWU7XG4gICAgICAgIFxuICAgICAgICAvLyBSZWFkIGEgc2FtcGxlIG9mIHRoZSBmaWxlIHRvIGNoZWNrIHZhbGlkaXR5XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgZmlsZUNvbnRlbnQgPSBmcy5yZWFkRmlsZVN5bmMoc29jaWFsR3JhcGhQYXRoLCAndXRmLTgnKTtcbiAgICAgICAgICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShmaWxlQ29udGVudCk7XG4gICAgICAgICAgZGlhZ25vc3RpY1Jlc3VsdHMuZmlsZXMuZGV0YWlscy5zb2NpYWxHcmFwaFZhbGlkID0gdHJ1ZTtcbiAgICAgICAgICBkaWFnbm9zdGljUmVzdWx0cy5maWxlcy5kZXRhaWxzLm5vZGVzQ291bnQgPSBkYXRhLm5vZGVzPy5sZW5ndGggfHwgMDtcbiAgICAgICAgICBkaWFnbm9zdGljUmVzdWx0cy5maWxlcy5kZXRhaWxzLmxpbmtzQ291bnQgPSBkYXRhLmxpbmtzPy5sZW5ndGggfHwgMDtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIGRpYWdub3N0aWNSZXN1bHRzLmZpbGVzLmRldGFpbHMuc29jaWFsR3JhcGhWYWxpZCA9IGZhbHNlO1xuICAgICAgICAgIGRpYWdub3N0aWNSZXN1bHRzLmZpbGVzLmRldGFpbHMuc29jaWFsR3JhcGhFcnJvciA9IChlIGFzIEVycm9yKS5tZXNzYWdlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmIChkaWFnbm9zdGljUmVzdWx0cy5maWxlcy5kZXRhaWxzLmtub3duUHVia2V5c0V4aXN0cykge1xuICAgICAgICBjb25zdCBzdGF0cyA9IGZzLnN0YXRTeW5jKGtub3duUHVia2V5c1BhdGgpO1xuICAgICAgICBkaWFnbm9zdGljUmVzdWx0cy5maWxlcy5kZXRhaWxzLmtub3duUHVia2V5c1NpemUgPSBzdGF0cy5zaXplO1xuICAgICAgICBkaWFnbm9zdGljUmVzdWx0cy5maWxlcy5kZXRhaWxzLmtub3duUHVia2V5c01vZGlmaWVkID0gc3RhdHMubXRpbWU7XG4gICAgICAgIFxuICAgICAgICAvLyBSZWFkIHRoZSBmaWxlIHRvIGNoZWNrIHZhbGlkaXR5XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgZmlsZUNvbnRlbnQgPSBmcy5yZWFkRmlsZVN5bmMoa25vd25QdWJrZXlzUGF0aCwgJ3V0Zi04Jyk7XG4gICAgICAgICAgY29uc3QgZGF0YSA9IEpTT04ucGFyc2UoZmlsZUNvbnRlbnQpO1xuICAgICAgICAgIGRpYWdub3N0aWNSZXN1bHRzLmZpbGVzLmRldGFpbHMua25vd25QdWJrZXlzVmFsaWQgPSB0cnVlO1xuICAgICAgICAgIGRpYWdub3N0aWNSZXN1bHRzLmZpbGVzLmRldGFpbHMucHVia2V5c0NvdW50ID0gT2JqZWN0LmtleXMoZGF0YS5ucHVicyB8fCB7fSkubGVuZ3RoO1xuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgZGlhZ25vc3RpY1Jlc3VsdHMuZmlsZXMuZGV0YWlscy5rbm93blB1YmtleXNWYWxpZCA9IGZhbHNlO1xuICAgICAgICAgIGRpYWdub3N0aWNSZXN1bHRzLmZpbGVzLmRldGFpbHMua25vd25QdWJrZXlzRXJyb3IgPSAoZSBhcyBFcnJvcikubWVzc2FnZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBTZXQgb3ZlcmFsbCBmaWxlIHN0YXR1c1xuICAgIGlmICghZGlhZ25vc3RpY1Jlc3VsdHMuZmlsZXMuZGV0YWlscy5kaXJlY3RvcnlFeGlzdHMpIHtcbiAgICAgIGRpYWdub3N0aWNSZXN1bHRzLmZpbGVzLnN0YXR1cyA9ICdlcnJvcic7XG4gICAgICBkaWFnbm9zdGljUmVzdWx0cy5maWxlcy5tZXNzYWdlID0gJ0RhdGEgZGlyZWN0b3J5IGRvZXMgbm90IGV4aXN0JztcbiAgICB9IGVsc2UgaWYgKCFkaWFnbm9zdGljUmVzdWx0cy5maWxlcy5kZXRhaWxzLnNvY2lhbEdyYXBoRXhpc3RzIHx8ICFkaWFnbm9zdGljUmVzdWx0cy5maWxlcy5kZXRhaWxzLmtub3duUHVia2V5c0V4aXN0cykge1xuICAgICAgZGlhZ25vc3RpY1Jlc3VsdHMuZmlsZXMuc3RhdHVzID0gJ3dhcm5pbmcnO1xuICAgICAgZGlhZ25vc3RpY1Jlc3VsdHMuZmlsZXMubWVzc2FnZSA9ICdPbmUgb3IgbW9yZSBkYXRhIGZpbGVzIG1pc3NpbmcnO1xuICAgIH0gZWxzZSBpZiAoIWRpYWdub3N0aWNSZXN1bHRzLmZpbGVzLmRldGFpbHMuc29jaWFsR3JhcGhWYWxpZCB8fCAhZGlhZ25vc3RpY1Jlc3VsdHMuZmlsZXMuZGV0YWlscy5rbm93blB1YmtleXNWYWxpZCkge1xuICAgICAgZGlhZ25vc3RpY1Jlc3VsdHMuZmlsZXMuc3RhdHVzID0gJ2Vycm9yJztcbiAgICAgIGRpYWdub3N0aWNSZXN1bHRzLmZpbGVzLm1lc3NhZ2UgPSAnT25lIG9yIG1vcmUgZGF0YSBmaWxlcyBhcmUgaW52YWxpZCc7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRpYWdub3N0aWNSZXN1bHRzLmZpbGVzLnN0YXR1cyA9ICdzdWNjZXNzJztcbiAgICAgIGRpYWdub3N0aWNSZXN1bHRzLmZpbGVzLm1lc3NhZ2UgPSAnQWxsIGRhdGEgZmlsZXMgZXhpc3QgYW5kIGFyZSB2YWxpZCc7XG4gICAgfVxuICAgIFxuICAgIC8vIENoZWNrIGRhdGEgZnJvbSBmZXRjaGVyXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGdyYXBoRGF0YSA9IGF3YWl0IGdldFNvY2lhbEdyYXBoRGF0YSgpO1xuICAgICAgZGlhZ25vc3RpY1Jlc3VsdHMuZGF0YS5kZXRhaWxzLmZldGNoU3VjY2VzcyA9IHRydWU7XG4gICAgICBkaWFnbm9zdGljUmVzdWx0cy5kYXRhLmRldGFpbHMuaGFzTm9kZXMgPSBCb29sZWFuKGdyYXBoRGF0YS5ub2RlcyAmJiBncmFwaERhdGEubm9kZXMubGVuZ3RoID4gMCk7XG4gICAgICBkaWFnbm9zdGljUmVzdWx0cy5kYXRhLmRldGFpbHMubm9kZXNDb3VudCA9IGdyYXBoRGF0YS5ub2Rlcz8ubGVuZ3RoIHx8IDA7XG4gICAgICBkaWFnbm9zdGljUmVzdWx0cy5kYXRhLmRldGFpbHMuaGFzTGlua3MgPSBCb29sZWFuKGdyYXBoRGF0YS5saW5rcyAmJiBncmFwaERhdGEubGlua3MubGVuZ3RoID4gMCk7XG4gICAgICBkaWFnbm9zdGljUmVzdWx0cy5kYXRhLmRldGFpbHMubGlua3NDb3VudCA9IGdyYXBoRGF0YS5saW5rcz8ubGVuZ3RoIHx8IDA7XG4gICAgICBcbiAgICAgIGlmIChkaWFnbm9zdGljUmVzdWx0cy5kYXRhLmRldGFpbHMubm9kZXNDb3VudCA+IDApIHtcbiAgICAgICAgZGlhZ25vc3RpY1Jlc3VsdHMuZGF0YS5kZXRhaWxzLnNhbXBsZU5vZGVzID0gZ3JhcGhEYXRhLm5vZGVzLnNsaWNlKDAsIDMpO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBDaGVjayBub2RlIHR5cGVzIGRpc3RyaWJ1dGlvblxuICAgICAgY29uc3Qgbm9kZVR5cGVzOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge307XG4gICAgICBpZiAoZ3JhcGhEYXRhLm5vZGVzKSB7XG4gICAgICAgIGdyYXBoRGF0YS5ub2Rlcy5mb3JFYWNoKChub2RlOiBhbnkpID0+IHtcbiAgICAgICAgICBjb25zdCB0eXBlID0gbm9kZS50eXBlIHx8ICd1bmtub3duJztcbiAgICAgICAgICBub2RlVHlwZXNbdHlwZV0gPSAobm9kZVR5cGVzW3R5cGVdIHx8IDApICsgMTtcbiAgICAgICAgfSk7XG4gICAgICAgIGRpYWdub3N0aWNSZXN1bHRzLmRhdGEuZGV0YWlscy5ub2RlVHlwZURpc3RyaWJ1dGlvbiA9IG5vZGVUeXBlcztcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gU2V0IGRhdGEgc3RhdHVzXG4gICAgICBpZiAoIWRpYWdub3N0aWNSZXN1bHRzLmRhdGEuZGV0YWlscy5oYXNOb2Rlcykge1xuICAgICAgICBkaWFnbm9zdGljUmVzdWx0cy5kYXRhLnN0YXR1cyA9ICdlcnJvcic7XG4gICAgICAgIGRpYWdub3N0aWNSZXN1bHRzLmRhdGEubWVzc2FnZSA9ICdObyBub2RlcyBmb3VuZCBpbiBzb2NpYWwgZ3JhcGggZGF0YSc7XG4gICAgICB9IGVsc2UgaWYgKCFkaWFnbm9zdGljUmVzdWx0cy5kYXRhLmRldGFpbHMuaGFzTGlua3MpIHtcbiAgICAgICAgZGlhZ25vc3RpY1Jlc3VsdHMuZGF0YS5zdGF0dXMgPSAnd2FybmluZyc7XG4gICAgICAgIGRpYWdub3N0aWNSZXN1bHRzLmRhdGEubWVzc2FnZSA9ICdOb2RlcyBmb3VuZCBidXQgbm8gbGlua3MgaW4gc29jaWFsIGdyYXBoIGRhdGEnO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZGlhZ25vc3RpY1Jlc3VsdHMuZGF0YS5zdGF0dXMgPSAnc3VjY2Vzcyc7XG4gICAgICAgIGRpYWdub3N0aWNSZXN1bHRzLmRhdGEubWVzc2FnZSA9IGBTb2NpYWwgZ3JhcGggaGFzICR7ZGlhZ25vc3RpY1Jlc3VsdHMuZGF0YS5kZXRhaWxzLm5vZGVzQ291bnR9IG5vZGVzIGFuZCAke2RpYWdub3N0aWNSZXN1bHRzLmRhdGEuZGV0YWlscy5saW5rc0NvdW50fSBsaW5rc2A7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgZGlhZ25vc3RpY1Jlc3VsdHMuZGF0YS5zdGF0dXMgPSAnZXJyb3InO1xuICAgICAgZGlhZ25vc3RpY1Jlc3VsdHMuZGF0YS5tZXNzYWdlID0gYEZhaWxlZCB0byBmZXRjaCBzb2NpYWwgZ3JhcGggZGF0YTogJHsoZSBhcyBFcnJvcikubWVzc2FnZX1gO1xuICAgICAgZGlhZ25vc3RpY1Jlc3VsdHMuZGF0YS5kZXRhaWxzLmZldGNoU3VjY2VzcyA9IGZhbHNlO1xuICAgICAgZGlhZ25vc3RpY1Jlc3VsdHMuZGF0YS5kZXRhaWxzLmVycm9yID0gKGUgYXMgRXJyb3IpLm1lc3NhZ2U7XG4gICAgfVxuICAgIFxuICAgIC8vIE92ZXJhbGwgQVBJIHN0YXR1c1xuICAgIGlmIChkaWFnbm9zdGljUmVzdWx0cy5maWxlcy5zdGF0dXMgPT09ICdlcnJvcicgfHwgZGlhZ25vc3RpY1Jlc3VsdHMuZGF0YS5zdGF0dXMgPT09ICdlcnJvcicpIHtcbiAgICAgIGRpYWdub3N0aWNSZXN1bHRzLmFwaS5zdGF0dXMgPSAnZXJyb3InO1xuICAgICAgZGlhZ25vc3RpY1Jlc3VsdHMuYXBpLm1lc3NhZ2UgPSAnQ3JpdGljYWwgaXNzdWVzIGZvdW5kIHdpdGggc29jaWFsIGdyYXBoIGRhdGEnO1xuICAgIH0gZWxzZSBpZiAoZGlhZ25vc3RpY1Jlc3VsdHMuZmlsZXMuc3RhdHVzID09PSAnd2FybmluZycgfHwgZGlhZ25vc3RpY1Jlc3VsdHMuZGF0YS5zdGF0dXMgPT09ICd3YXJuaW5nJykge1xuICAgICAgZGlhZ25vc3RpY1Jlc3VsdHMuYXBpLnN0YXR1cyA9ICd3YXJuaW5nJztcbiAgICAgIGRpYWdub3N0aWNSZXN1bHRzLmFwaS5tZXNzYWdlID0gJ05vbi1jcml0aWNhbCBpc3N1ZXMgZm91bmQgd2l0aCBzb2NpYWwgZ3JhcGggZGF0YSc7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRpYWdub3N0aWNSZXN1bHRzLmFwaS5zdGF0dXMgPSAnc3VjY2Vzcyc7XG4gICAgICBkaWFnbm9zdGljUmVzdWx0cy5hcGkubWVzc2FnZSA9ICdTb2NpYWwgZ3JhcGggZGF0YSBpcyBoZWFsdGh5JztcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIG1lc3NhZ2U6ICdEaWFnbm9zaXMgY29tcGxldGUnLFxuICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgcmVzdWx0czogZGlhZ25vc3RpY1Jlc3VsdHMsXG4gICAgICByZWNvbW1lbmRhdGlvbnM6IGdlbmVyYXRlUmVjb21tZW5kYXRpb25zKGRpYWdub3N0aWNSZXN1bHRzKVxuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0RpYWdub3NpcyBlcnJvcjonLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBcbiAgICAgICAgbWVzc2FnZTogJ0RpYWdub3NpcyBmYWlsZWQnLCBcbiAgICAgICAgZXJyb3I6IChlcnJvciBhcyBFcnJvcikubWVzc2FnZSxcbiAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpXG4gICAgICB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZVJlY29tbWVuZGF0aW9ucyhyZXN1bHRzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+KTogc3RyaW5nW10ge1xuICBjb25zdCByZWNvbW1lbmRhdGlvbnM6IHN0cmluZ1tdID0gW107XG4gIFxuICBpZiAocmVzdWx0cy5maWxlcy5zdGF0dXMgIT09ICdzdWNjZXNzJykge1xuICAgIGlmICghcmVzdWx0cy5maWxlcy5kZXRhaWxzLmRpcmVjdG9yeUV4aXN0cykge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ0NyZWF0ZSB0aGUgZGF0YSBkaXJlY3RvcnkgYXQgdGhlIHJvb3Qgb2YgeW91ciBwcm9qZWN0Jyk7XG4gICAgfVxuICAgIGlmICghcmVzdWx0cy5maWxlcy5kZXRhaWxzLnNvY2lhbEdyYXBoRXhpc3RzKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnSW5pdGlhbGl6ZSB0aGUgc29jaWFsLWdyYXBoLmpzb24gZmlsZSB3aXRoIGEgdmFsaWQgZ3JhcGggc3RydWN0dXJlOiB7XCJub2Rlc1wiOltdLFwibGlua3NcIjpbXX0nKTtcbiAgICB9XG4gICAgaWYgKCFyZXN1bHRzLmZpbGVzLmRldGFpbHMua25vd25QdWJrZXlzRXhpc3RzKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnSW5pdGlhbGl6ZSB0aGUga25vd24tcHVia2V5cy5qc29uIGZpbGUgd2l0aCBhIHZhbGlkIHN0cnVjdHVyZToge1wibnB1YnNcIjp7fX0nKTtcbiAgICB9XG4gICAgaWYgKHJlc3VsdHMuZmlsZXMuZGV0YWlscy5zb2NpYWxHcmFwaEV4aXN0cyAmJiAhcmVzdWx0cy5maWxlcy5kZXRhaWxzLnNvY2lhbEdyYXBoVmFsaWQpIHtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdGaXggdGhlIHNvY2lhbC1ncmFwaC5qc29uIGZpbGUgLSBpdCBjb250YWlucyBpbnZhbGlkIEpTT04nKTtcbiAgICB9XG4gICAgaWYgKHJlc3VsdHMuZmlsZXMuZGV0YWlscy5rbm93blB1YmtleXNFeGlzdHMgJiYgIXJlc3VsdHMuZmlsZXMuZGV0YWlscy5rbm93blB1YmtleXNWYWxpZCkge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ0ZpeCB0aGUga25vd24tcHVia2V5cy5qc29uIGZpbGUgLSBpdCBjb250YWlucyBpbnZhbGlkIEpTT04nKTtcbiAgICB9XG4gIH1cbiAgXG4gIGlmIChyZXN1bHRzLmRhdGEuc3RhdHVzICE9PSAnc3VjY2VzcycpIHtcbiAgICBpZiAoIXJlc3VsdHMuZGF0YS5kZXRhaWxzLmZldGNoU3VjY2Vzcykge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ0NoZWNrIHRoZSBnZXRTb2NpYWxHcmFwaERhdGEgZnVuY3Rpb24gZm9yIGVycm9ycycpO1xuICAgIH0gZWxzZSBpZiAoIXJlc3VsdHMuZGF0YS5kZXRhaWxzLmhhc05vZGVzKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnVGhlIHNvY2lhbCBncmFwaCBoYXMgbm8gbm9kZXMuIFRyeSB1cGRhdGluZyBpdCB3aXRoIGtub3duIG5wdWJzJyk7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnVXNlIHRoZSBhZG1pbiBVSSBvciBBUEkgdG8gYWRkIGluaXRpYWwgbnB1YnMnKTtcbiAgICB9IGVsc2UgaWYgKCFyZXN1bHRzLmRhdGEuZGV0YWlscy5oYXNMaW5rcykge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ1RoZSBzb2NpYWwgZ3JhcGggaGFzIG5vZGVzIGJ1dCBubyBsaW5rcy4gVGhpcyBzdWdnZXN0cyBpbmNvbXBsZXRlIGRhdGEnKTtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdUcnkgdXBkYXRpbmcgbW9yZSBucHVicyBvciBjaGVja2luZyB0aGUgbGluayBnZW5lcmF0aW9uIGxvZ2ljJyk7XG4gICAgfVxuICB9XG4gIFxuICAvLyBDaGVjayBmaWxlIHNpemVzXG4gIGlmIChyZXN1bHRzLmZpbGVzLmRldGFpbHMuc29jaWFsR3JhcGhTaXplICYmIHJlc3VsdHMuZmlsZXMuZGV0YWlscy5zb2NpYWxHcmFwaFNpemUgPCAxMDApIHtcbiAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnVGhlIHNvY2lhbC1ncmFwaC5qc29uIGZpbGUgaXMgc3VzcGljaW91c2x5IHNtYWxsLiBJdCBtYXkgYmUgZW1wdHkgb3IgaW5pdGlhbGl6ZWQgaW5jb3JyZWN0bHknKTtcbiAgfVxuICBcbiAgLy8gQWRkIGdlbmVyYWwgcmVjb21tZW5kYXRpb25zXG4gIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdWaXNpdCB0aGUgYWRtaW4gcGFnZSBhdCAvYWRtaW4vc29jaWFsZ3JhcGggdG8gbWFuYWdlIHRoZSBzb2NpYWwgZ3JhcGgnKTtcbiAgcmVjb21tZW5kYXRpb25zLnB1c2goJ0lmIHZpc3VhbGl6YXRpb24gaXNzdWVzIHBlcnNpc3QsIGNoZWNrIHRoZSBicm93c2VyIGNvbnNvbGUgZm9yIGNsaWVudC1zaWRlIGVycm9ycycpO1xuICBcbiAgcmV0dXJuIHJlY29tbWVuZGF0aW9ucztcbn0gIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsInBhdGgiLCJmcyIsImdldFNvY2lhbEdyYXBoRGF0YSIsIkdFVCIsImRpYWdub3N0aWNSZXN1bHRzIiwiZmlsZXMiLCJzdGF0dXMiLCJkZXRhaWxzIiwiZGF0YSIsImFwaSIsImRhdGFEaXIiLCJqb2luIiwicHJvY2VzcyIsImN3ZCIsInNvY2lhbEdyYXBoUGF0aCIsImtub3duUHVia2V5c1BhdGgiLCJkaXJlY3RvcnlFeGlzdHMiLCJleGlzdHNTeW5jIiwic29jaWFsR3JhcGhFeGlzdHMiLCJrbm93blB1YmtleXNFeGlzdHMiLCJzdGF0cyIsInN0YXRTeW5jIiwic29jaWFsR3JhcGhTaXplIiwic2l6ZSIsInNvY2lhbEdyYXBoTW9kaWZpZWQiLCJtdGltZSIsImZpbGVDb250ZW50IiwicmVhZEZpbGVTeW5jIiwiSlNPTiIsInBhcnNlIiwic29jaWFsR3JhcGhWYWxpZCIsIm5vZGVzQ291bnQiLCJub2RlcyIsImxlbmd0aCIsImxpbmtzQ291bnQiLCJsaW5rcyIsImUiLCJzb2NpYWxHcmFwaEVycm9yIiwibWVzc2FnZSIsImtub3duUHVia2V5c1NpemUiLCJrbm93blB1YmtleXNNb2RpZmllZCIsImtub3duUHVia2V5c1ZhbGlkIiwicHVia2V5c0NvdW50IiwiT2JqZWN0Iiwia2V5cyIsIm5wdWJzIiwia25vd25QdWJrZXlzRXJyb3IiLCJncmFwaERhdGEiLCJmZXRjaFN1Y2Nlc3MiLCJoYXNOb2RlcyIsIkJvb2xlYW4iLCJoYXNMaW5rcyIsInNhbXBsZU5vZGVzIiwic2xpY2UiLCJub2RlVHlwZXMiLCJmb3JFYWNoIiwibm9kZSIsInR5cGUiLCJub2RlVHlwZURpc3RyaWJ1dGlvbiIsImVycm9yIiwianNvbiIsInRpbWVzdGFtcCIsIkRhdGUiLCJub3ciLCJyZXN1bHRzIiwicmVjb21tZW5kYXRpb25zIiwiZ2VuZXJhdGVSZWNvbW1lbmRhdGlvbnMiLCJjb25zb2xlIiwicHVzaCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/diagnosis/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/nostr/NostrSocialGraphFetcher.ts":
/*!**************************************************!*\
  !*** ./src/lib/nostr/NostrSocialGraphFetcher.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addKnownNpub: () => (/* binding */ addKnownNpub),\n/* harmony export */   forceSocialGraphUpdate: () => (/* binding */ forceSocialGraphUpdate),\n/* harmony export */   getKnownNpubsData: () => (/* binding */ getKnownNpubsData),\n/* harmony export */   getRawSocialGraphData: () => (/* binding */ getRawSocialGraphData),\n/* harmony export */   getSocialGraphData: () => (/* binding */ getSocialGraphData),\n/* harmony export */   setupScheduledUpdate: () => (/* binding */ setupScheduledUpdate)\n/* harmony export */ });\n/* harmony import */ var nostr_tools__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! nostr-tools */ \"(rsc)/./node_modules/nostr-tools/lib/esm/index.js\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs/promises */ \"fs/promises\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs_promises__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./config */ \"(rsc)/./src/lib/nostr/config.ts\");\n\n\n\n\n// Helper function to convert npub to hex pubkey\nfunction npubToHex(npub) {\n    if (!npub || !npub.startsWith('npub1')) return null;\n    try {\n        const result = nostr_tools__WEBPACK_IMPORTED_MODULE_3__.nip19.decode(npub);\n        return result.type === 'npub' ? result.data : null;\n    } catch (error) {\n        console.error('Failed to decode npub:', error);\n        return null;\n    }\n}\n// Helper function to convert hex pubkey to npub\nfunction hexToNpub(hex) {\n    if (!hex) return null;\n    try {\n        return nostr_tools__WEBPACK_IMPORTED_MODULE_3__.nip19.npubEncode(hex);\n    } catch (error) {\n        console.error('Failed to encode hex to npub:', error);\n        return null;\n    }\n}\n// Helper to ensure our data directories exist\nasync function ensureDataDirectories() {\n    try {\n        await (0,fs_promises__WEBPACK_IMPORTED_MODULE_0__.mkdir)(path__WEBPACK_IMPORTED_MODULE_1___default().dirname(_config__WEBPACK_IMPORTED_MODULE_2__.NOSTR_CONFIG.socialGraphFile), {\n            recursive: true\n        });\n    } catch (err) {\n        console.error('Error creating data directory:', err);\n    }\n    try {\n        await (0,fs_promises__WEBPACK_IMPORTED_MODULE_0__.readFile)(_config__WEBPACK_IMPORTED_MODULE_2__.NOSTR_CONFIG.socialGraphFile);\n    } catch (error) {\n        // Initialize empty social graph file\n        const initialData = {\n            lastUpdated: Date.now(),\n            members: {}\n        };\n        await (0,fs_promises__WEBPACK_IMPORTED_MODULE_0__.writeFile)(_config__WEBPACK_IMPORTED_MODULE_2__.NOSTR_CONFIG.socialGraphFile, JSON.stringify(initialData, null, 2));\n    }\n    try {\n        await (0,fs_promises__WEBPACK_IMPORTED_MODULE_0__.readFile)(_config__WEBPACK_IMPORTED_MODULE_2__.NOSTR_CONFIG.knownPubkeysFile);\n    } catch (error) {\n        // Initialize empty known npubs file with our initial known pubkeys\n        const initialKnownNpubs = {\n            lastUpdated: Date.now(),\n            npubs: {}\n        };\n        // Add initial npubs from config\n        for (const npub of _config__WEBPACK_IMPORTED_MODULE_2__.NOSTR_CONFIG.initialKnownNpubs){\n            const hex = npubToHex(npub);\n            if (hex) {\n                // Determine the group based on npub\n                let group = 'other';\n                // Check if it's the Free Madeira npub\n                if (npub === 'npub1etgqcj9gc6yaxttuwu9eqgs3ynt2dzaudvwnrssrn2zdt2useaasfj8n6e') {\n                    group = 'freeMadeira';\n                } else if (npub === 'npub1dxd02kcjhgpkyrx60qnkd6j42kmc72u5lum0rp2ud8x5zfhnk4zscjj6hh') {\n                    group = 'agency';\n                }\n                initialKnownNpubs.npubs[hex] = {\n                    group,\n                    firstSeen: Date.now(),\n                    lastSeen: Date.now()\n                };\n            }\n        }\n        await (0,fs_promises__WEBPACK_IMPORTED_MODULE_0__.writeFile)(_config__WEBPACK_IMPORTED_MODULE_2__.NOSTR_CONFIG.knownPubkeysFile, JSON.stringify(initialKnownNpubs, null, 2));\n    }\n}\n// Load current social graph data\nasync function loadSocialGraphData() {\n    try {\n        const data = await (0,fs_promises__WEBPACK_IMPORTED_MODULE_0__.readFile)(_config__WEBPACK_IMPORTED_MODULE_2__.NOSTR_CONFIG.socialGraphFile, 'utf8');\n        return JSON.parse(data);\n    } catch (error) {\n        console.error('Error loading social graph data:', error);\n        return {\n            lastUpdated: 0,\n            members: {}\n        };\n    }\n}\n// Load current known npubs data\nasync function loadKnownNpubsData() {\n    try {\n        const data = await (0,fs_promises__WEBPACK_IMPORTED_MODULE_0__.readFile)(_config__WEBPACK_IMPORTED_MODULE_2__.NOSTR_CONFIG.knownPubkeysFile, 'utf8');\n        return JSON.parse(data);\n    } catch (error) {\n        console.error('Error loading known npubs data:', error);\n        return {\n            lastUpdated: 0,\n            npubs: {}\n        };\n    }\n}\n// Save updated social graph data\nasync function saveSocialGraphData(data) {\n    try {\n        data.lastUpdated = Date.now();\n        await (0,fs_promises__WEBPACK_IMPORTED_MODULE_0__.writeFile)(_config__WEBPACK_IMPORTED_MODULE_2__.NOSTR_CONFIG.socialGraphFile, JSON.stringify(data, null, 2));\n    } catch (error) {\n        console.error('Error saving social graph data:', error);\n    }\n}\n// Save updated known npubs data\nasync function saveKnownNpubsData(data) {\n    try {\n        data.lastUpdated = Date.now();\n        await (0,fs_promises__WEBPACK_IMPORTED_MODULE_0__.writeFile)(_config__WEBPACK_IMPORTED_MODULE_2__.NOSTR_CONFIG.knownPubkeysFile, JSON.stringify(data, null, 2));\n    } catch (error) {\n        console.error('Error saving known npubs data:', error);\n    }\n}\n// Add a new npub to our known npubs\nasync function addKnownNpub(npub, group = 'other') {\n    const hex = npubToHex(npub);\n    if (!hex) return false;\n    const knownNpubs = await loadKnownNpubsData();\n    // Add or update the npub\n    knownNpubs.npubs[hex] = {\n        group,\n        firstSeen: knownNpubs.npubs[hex]?.firstSeen || Date.now(),\n        lastSeen: Date.now()\n    };\n    await saveKnownNpubsData(knownNpubs);\n    return true;\n}\n// Fetch profile metadata (kind:0) for a specific pubkey\nasync function fetchProfileMetadata(pubkey) {\n    const pool = new nostr_tools__WEBPACK_IMPORTED_MODULE_3__.SimplePool();\n    let metadata = null;\n    try {\n        // Using the subscribeMany method instead of list since list is not available in this version\n        const metadataPromise = new Promise((resolve)=>{\n            let foundMetadata = null;\n            const subscription = pool.subscribeMany(_config__WEBPACK_IMPORTED_MODULE_2__.NOSTR_CONFIG.defaultRelays, [\n                {\n                    kinds: [\n                        0\n                    ],\n                    authors: [\n                        pubkey\n                    ],\n                    limit: 1\n                }\n            ], {\n                onevent (event) {\n                    try {\n                        foundMetadata = JSON.parse(event.content);\n                    } catch (e) {\n                        console.error('Failed to parse profile metadata:', e);\n                    }\n                },\n                oneose () {\n                    setTimeout(()=>{\n                        subscription.close();\n                        resolve(foundMetadata);\n                    }, 1000);\n                }\n            });\n            // Set a timeout in case we don't get EOSE\n            setTimeout(()=>{\n                subscription.close();\n                resolve(foundMetadata);\n            }, _config__WEBPACK_IMPORTED_MODULE_2__.NOSTR_CONFIG.fetchTimeoutMs);\n        });\n        metadata = await metadataPromise;\n        pool.close(_config__WEBPACK_IMPORTED_MODULE_2__.NOSTR_CONFIG.defaultRelays);\n        return metadata;\n    } catch (error) {\n        console.error('Error fetching profile metadata:', error);\n        pool.close(_config__WEBPACK_IMPORTED_MODULE_2__.NOSTR_CONFIG.defaultRelays);\n        return null;\n    }\n}\n// Fetch follows (kind:3) events from a specific pubkey\nasync function fetchFollows(pubkey) {\n    const pool = new nostr_tools__WEBPACK_IMPORTED_MODULE_3__.SimplePool();\n    const follows = [];\n    try {\n        // Create a promise to handle the subscription\n        const followsPromise = new Promise((resolve)=>{\n            const subscription = pool.subscribeMany(_config__WEBPACK_IMPORTED_MODULE_2__.NOSTR_CONFIG.defaultRelays, [\n                {\n                    kinds: [\n                        3\n                    ],\n                    authors: [\n                        pubkey\n                    ],\n                    limit: 1 // We just need the most recent one\n                }\n            ], {\n                onevent (event) {\n                    try {\n                        // Extract 'p' tags which contain followed pubkeys\n                        const followedPubkeys = event.tags.filter((tag)=>tag[0] === 'p').map((tag)=>tag[1]);\n                        follows.push(...followedPubkeys);\n                    } catch (e) {\n                        console.error('Failed to parse follows:', e);\n                    }\n                },\n                oneose () {\n                    // After EOSE (End of Stored Events)\n                    setTimeout(()=>{\n                        subscription.close();\n                        resolve(follows);\n                    }, 1000); // Give it a second to receive any last events\n                }\n            });\n            // Set a timeout in case we don't get EOSE\n            setTimeout(()=>{\n                subscription.close();\n                resolve(follows);\n            }, _config__WEBPACK_IMPORTED_MODULE_2__.NOSTR_CONFIG.fetchTimeoutMs);\n        });\n        // Wait for the promise to resolve\n        const result = await followsPromise;\n        pool.close(_config__WEBPACK_IMPORTED_MODULE_2__.NOSTR_CONFIG.defaultRelays);\n        return result;\n    } catch (error) {\n        console.error('Error fetching follows:', error);\n        pool.close(_config__WEBPACK_IMPORTED_MODULE_2__.NOSTR_CONFIG.defaultRelays);\n        return [];\n    }\n}\n// Fetch interactions (mentions, likes, reposts, zaps) related to a pubkey\nasync function fetchInteractions(pubkey, since = 0) {\n    const pool = new nostr_tools__WEBPACK_IMPORTED_MODULE_3__.SimplePool();\n    const interactions = {\n        mentions: [],\n        likes: [],\n        reposts: [],\n        zaps: []\n    };\n    try {\n        // Create a promise to handle the subscription\n        const interactionsPromise = new Promise((resolve)=>{\n            const subscription = pool.subscribeMany(_config__WEBPACK_IMPORTED_MODULE_2__.NOSTR_CONFIG.defaultRelays, [\n                {\n                    kinds: [\n                        1,\n                        6,\n                        7,\n                        9735\n                    ],\n                    '#p': [\n                        pubkey\n                    ],\n                    since: since > 0 ? since : undefined,\n                    limit: _config__WEBPACK_IMPORTED_MODULE_2__.NOSTR_CONFIG.maxEventsPerRelay\n                }\n            ], {\n                onevent (event) {\n                    try {\n                        switch(event.kind){\n                            case 1:\n                                // Add author to mentions\n                                interactions.mentions.push(event.pubkey);\n                                break;\n                            case 6:\n                                // Add author to reposts\n                                interactions.reposts.push(event.pubkey);\n                                break;\n                            case 7:\n                                // Add author to likes\n                                interactions.likes.push(event.pubkey);\n                                break;\n                            case 9735:\n                                // Try to parse zap amount from tags\n                                const amountTag = event.tags.find((tag)=>tag[0] === 'amount');\n                                if (amountTag && amountTag[1]) {\n                                    const amount = parseInt(amountTag[1], 10);\n                                    if (!isNaN(amount)) {\n                                        interactions.zaps.push({\n                                            target: pubkey,\n                                            amount: amount,\n                                            timestamp: event.created_at\n                                        });\n                                    }\n                                }\n                                break;\n                        }\n                    } catch (e) {\n                        console.error('Failed to parse interaction:', e);\n                    }\n                },\n                oneose () {\n                    // After EOSE (End of Stored Events)\n                    setTimeout(()=>{\n                        subscription.close();\n                        resolve(interactions);\n                    }, 1000); // Give it a second to receive any last events\n                }\n            });\n            // Set a timeout in case we don't get EOSE\n            setTimeout(()=>{\n                subscription.close();\n                resolve(interactions);\n            }, _config__WEBPACK_IMPORTED_MODULE_2__.NOSTR_CONFIG.fetchTimeoutMs);\n        });\n        // Wait for the promise to resolve\n        const result = await interactionsPromise;\n        pool.close(_config__WEBPACK_IMPORTED_MODULE_2__.NOSTR_CONFIG.defaultRelays);\n        return result;\n    } catch (error) {\n        console.error('Error fetching interactions:', error);\n        pool.close(_config__WEBPACK_IMPORTED_MODULE_2__.NOSTR_CONFIG.defaultRelays);\n        return interactions;\n    }\n}\n// Update social graph with new data\nasync function updateSocialGraph() {\n    // Ensure data directories exist\n    await ensureDataDirectories();\n    // Load current data\n    const socialGraph = await loadSocialGraphData();\n    const knownNpubs = await loadKnownNpubsData();\n    // Get Free Madeira members (those with group 'freeMadeira')\n    const freeMadeiraMembers = Object.entries(knownNpubs.npubs).filter(([_, data])=>data.group === 'freeMadeira').map(([pubkey])=>pubkey);\n    // Get agency pubkeys\n    const agencyPubkeys = Object.entries(knownNpubs.npubs).filter(([_, data])=>data.group === 'agency').map(([pubkey])=>pubkey);\n    // Process Free Madeira members\n    for (const pubkey of freeMadeiraMembers){\n        console.log(`Processing Free Madeira member: ${pubkey}`);\n        // Initialize member data if not exists\n        if (!socialGraph.members[pubkey]) {\n            socialGraph.members[pubkey] = {\n                follows: [],\n                followers: [],\n                mentions: [],\n                zaps: [],\n                likes: [],\n                reposts: []\n            };\n        }\n        // Get profile metadata\n        const metadata = await fetchProfileMetadata(pubkey);\n        if (metadata) {\n            socialGraph.members[pubkey].metadata = {\n                name: metadata.name,\n                displayName: metadata.display_name || metadata.displayName,\n                picture: metadata.picture,\n                about: metadata.about,\n                nip05: metadata.nip05\n            };\n        }\n        // Get follows\n        const follows = await fetchFollows(pubkey);\n        socialGraph.members[pubkey].follows = follows;\n        // Add new pubkeys to known npubs\n        for (const followedPubkey of follows){\n            if (!knownNpubs.npubs[followedPubkey]) {\n                knownNpubs.npubs[followedPubkey] = {\n                    group: 'other',\n                    firstSeen: Date.now(),\n                    lastSeen: Date.now()\n                };\n            } else {\n                knownNpubs.npubs[followedPubkey].lastSeen = Date.now();\n            }\n            // Initialize followed member data if not exists\n            if (!socialGraph.members[followedPubkey]) {\n                socialGraph.members[followedPubkey] = {\n                    follows: [],\n                    followers: [],\n                    mentions: [],\n                    zaps: [],\n                    likes: [],\n                    reposts: []\n                };\n            }\n            // Add follower\n            if (!socialGraph.members[followedPubkey].followers.includes(pubkey)) {\n                socialGraph.members[followedPubkey].followers.push(pubkey);\n            }\n        }\n        // Fetch metadata for followed accounts if needed\n        for (const followedPubkey of follows){\n            if (!socialGraph.members[followedPubkey].metadata) {\n                const followedMetadata = await fetchProfileMetadata(followedPubkey);\n                if (followedMetadata) {\n                    socialGraph.members[followedPubkey].metadata = {\n                        name: followedMetadata.name,\n                        displayName: followedMetadata.display_name || followedMetadata.displayName,\n                        picture: followedMetadata.picture,\n                        about: followedMetadata.about,\n                        nip05: followedMetadata.nip05\n                    };\n                }\n            }\n        }\n    }\n    // Process agency interactions\n    for (const pubkey of agencyPubkeys){\n        console.log(`Processing agency account: ${pubkey}`);\n        // Initialize member data if not exists\n        if (!socialGraph.members[pubkey]) {\n            socialGraph.members[pubkey] = {\n                follows: [],\n                followers: [],\n                mentions: [],\n                zaps: [],\n                likes: [],\n                reposts: []\n            };\n        }\n        // Get profile metadata\n        const metadata = await fetchProfileMetadata(pubkey);\n        if (metadata) {\n            socialGraph.members[pubkey].metadata = {\n                name: metadata.name,\n                displayName: metadata.display_name || metadata.displayName,\n                picture: metadata.picture,\n                about: metadata.about,\n                nip05: metadata.nip05\n            };\n        }\n        // Calculate since timestamp (1 week ago)\n        const oneWeekAgo = Math.floor(Date.now() / 1000) - 7 * 24 * 60 * 60;\n        // Get interactions\n        const interactions = await fetchInteractions(pubkey, oneWeekAgo);\n        // Update interactions\n        for (const mentionPubkey of interactions.mentions){\n            if (!socialGraph.members[pubkey].mentions.includes(mentionPubkey)) {\n                socialGraph.members[pubkey].mentions.push(mentionPubkey);\n            }\n            // Add to known npubs\n            if (!knownNpubs.npubs[mentionPubkey]) {\n                knownNpubs.npubs[mentionPubkey] = {\n                    group: 'other',\n                    firstSeen: Date.now(),\n                    lastSeen: Date.now()\n                };\n            } else {\n                knownNpubs.npubs[mentionPubkey].lastSeen = Date.now();\n            }\n        }\n        for (const likePubkey of interactions.likes){\n            if (!socialGraph.members[pubkey].likes.includes(likePubkey)) {\n                socialGraph.members[pubkey].likes.push(likePubkey);\n            }\n            // Add to known npubs\n            if (!knownNpubs.npubs[likePubkey]) {\n                knownNpubs.npubs[likePubkey] = {\n                    group: 'other',\n                    firstSeen: Date.now(),\n                    lastSeen: Date.now()\n                };\n            } else {\n                knownNpubs.npubs[likePubkey].lastSeen = Date.now();\n            }\n        }\n        for (const repostPubkey of interactions.reposts){\n            if (!socialGraph.members[pubkey].reposts.includes(repostPubkey)) {\n                socialGraph.members[pubkey].reposts.push(repostPubkey);\n            }\n            // Add to known npubs\n            if (!knownNpubs.npubs[repostPubkey]) {\n                knownNpubs.npubs[repostPubkey] = {\n                    group: 'other',\n                    firstSeen: Date.now(),\n                    lastSeen: Date.now()\n                };\n            } else {\n                knownNpubs.npubs[repostPubkey].lastSeen = Date.now();\n            }\n        }\n        // Add zaps\n        socialGraph.members[pubkey].zaps.push(...interactions.zaps);\n    }\n    // Save updated data\n    await saveSocialGraphData(socialGraph);\n    await saveKnownNpubsData(knownNpubs);\n    return {\n        socialGraph,\n        knownNpubs\n    };\n}\n// Convert social graph data to visualization format\nfunction socialGraphToVisGraph(socialGraph, knownNpubs) {\n    const nodes = [];\n    const links = [];\n    const nodeMap = new Map();\n    // Helper to determine node type\n    function getNodeType(pubkey) {\n        const npubData = knownNpubs.npubs[pubkey];\n        if (!npubData) return _config__WEBPACK_IMPORTED_MODULE_2__.NodeType.FOLLOWING;\n        if (npubData.group === 'freeMadeira') {\n            return _config__WEBPACK_IMPORTED_MODULE_2__.NodeType.CORE;\n        }\n        // Check if it's mutual with any core member\n        const member = socialGraph.members[pubkey];\n        if (!member) return _config__WEBPACK_IMPORTED_MODULE_2__.NodeType.FOLLOWING;\n        const coreMembers = Object.entries(knownNpubs.npubs).filter(([_, data])=>data.group === 'freeMadeira').map(([pubkey])=>pubkey);\n        // Check if this pubkey follows any core members\n        const followsCore = member.follows.some((followedPubkey)=>coreMembers.includes(followedPubkey));\n        // Check if this pubkey is followed by any core members\n        const followedByCore = member.followers.some((followerPubkey)=>coreMembers.includes(followerPubkey));\n        if (followsCore && followedByCore) {\n            return _config__WEBPACK_IMPORTED_MODULE_2__.NodeType.MUTUAL;\n        } else if (followsCore) {\n            return _config__WEBPACK_IMPORTED_MODULE_2__.NodeType.FOLLOWER;\n        } else if (followedByCore) {\n            return _config__WEBPACK_IMPORTED_MODULE_2__.NodeType.FOLLOWING;\n        }\n        return _config__WEBPACK_IMPORTED_MODULE_2__.NodeType.FOLLOWING;\n    }\n    // Add nodes for each member\n    Object.keys(socialGraph.members).forEach((pubkey)=>{\n        if (nodeMap.has(pubkey)) return;\n        const member = socialGraph.members[pubkey];\n        let npub;\n        try {\n            npub = hexToNpub(pubkey) || 'unknown';\n        } catch (e) {\n            npub = 'unknown';\n        }\n        nodes.push({\n            id: pubkey,\n            name: member.metadata?.displayName || member.metadata?.name,\n            npub,\n            type: getNodeType(pubkey),\n            picture: member.metadata?.picture\n        });\n        nodeMap.set(pubkey, true);\n    });\n    // Add links for follows\n    Object.keys(socialGraph.members).forEach((pubkey)=>{\n        const member = socialGraph.members[pubkey];\n        member.follows.forEach((targetPubkey)=>{\n            // Only add links where both nodes exist\n            if (socialGraph.members[targetPubkey]) {\n                links.push({\n                    source: pubkey,\n                    target: targetPubkey,\n                    value: 1,\n                    type: 'follows'\n                });\n            }\n        });\n    });\n    return {\n        nodes,\n        links,\n        timestamp: socialGraph.lastUpdated\n    };\n}\n// API to get social graph data in visualization format\nasync function getSocialGraphData() {\n    await ensureDataDirectories();\n    const socialGraph = await loadSocialGraphData();\n    const knownNpubs = await loadKnownNpubsData();\n    return socialGraphToVisGraph(socialGraph, knownNpubs);\n}\n// API to get raw social graph data\nasync function getRawSocialGraphData() {\n    await ensureDataDirectories();\n    return await loadSocialGraphData();\n}\n// API to get known npubs data\nasync function getKnownNpubsData() {\n    await ensureDataDirectories();\n    return await loadKnownNpubsData();\n}\n// API to force update the social graph\nasync function forceSocialGraphUpdate() {\n    await updateSocialGraph();\n    return await getSocialGraphData();\n}\n// Set up a scheduled update (can be called from a Next.js API route)\nasync function setupScheduledUpdate(intervalInHours = 24) {\n    // First update immediately\n    await updateSocialGraph();\n    // Then schedule regular updates\n    setInterval(async ()=>{\n        await updateSocialGraph();\n    }, intervalInHours * 60 * 60 * 1000);\n}\n// Export utility functions\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL25vc3RyL05vc3RyU29jaWFsR3JhcGhGZXRjaGVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUF1RDtBQUNFO0FBQ2pDO0FBQzBCO0FBNkRsRCxnREFBZ0Q7QUFDaEQsU0FBU1EsVUFBVUMsSUFBWTtJQUM3QixJQUFJLENBQUNBLFFBQVEsQ0FBQ0EsS0FBS0MsVUFBVSxDQUFDLFVBQVUsT0FBTztJQUUvQyxJQUFJO1FBQ0YsTUFBTUMsU0FBU1YsOENBQUtBLENBQUNXLE1BQU0sQ0FBQ0g7UUFDNUIsT0FBT0UsT0FBT0UsSUFBSSxLQUFLLFNBQVNGLE9BQU9HLElBQUksR0FBRztJQUNoRCxFQUFFLE9BQU9DLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLDBCQUEwQkE7UUFDeEMsT0FBTztJQUNUO0FBQ0Y7QUFFQSxnREFBZ0Q7QUFDaEQsU0FBU0UsVUFBVUMsR0FBVztJQUM1QixJQUFJLENBQUNBLEtBQUssT0FBTztJQUVqQixJQUFJO1FBQ0YsT0FBT2pCLDhDQUFLQSxDQUFDa0IsVUFBVSxDQUFDRDtJQUMxQixFQUFFLE9BQU9ILE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLGlDQUFpQ0E7UUFDL0MsT0FBTztJQUNUO0FBQ0Y7QUFFQSw4Q0FBOEM7QUFDOUMsZUFBZUs7SUFDYixJQUFJO1FBQ0YsTUFBTWhCLGtEQUFLQSxDQUFDQyxtREFBWSxDQUFDQyxpREFBWUEsQ0FBQ2dCLGVBQWUsR0FBRztZQUFFQyxXQUFXO1FBQUs7SUFDNUUsRUFBRSxPQUFPQyxLQUFLO1FBQ1pSLFFBQVFELEtBQUssQ0FBQyxrQ0FBa0NTO0lBQ2xEO0lBRUEsSUFBSTtRQUNGLE1BQU1yQixxREFBUUEsQ0FBQ0csaURBQVlBLENBQUNnQixlQUFlO0lBQzdDLEVBQUUsT0FBT1AsT0FBTztRQUNkLHFDQUFxQztRQUNyQyxNQUFNVSxjQUErQjtZQUNuQ0MsYUFBYUMsS0FBS0MsR0FBRztZQUNyQkMsU0FBUyxDQUFDO1FBQ1o7UUFDQSxNQUFN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LGVBQWUyRztJQUNwQixNQUFNcEQ7SUFDTixPQUFPLE1BQU1pRDtBQUNmO0FBRUEscUVBQXFFO0FBQzlELGVBQWVJLHFCQUFxQkMsa0JBQWtCLEVBQUU7SUFDN0QsMkJBQTJCO0lBQzNCLE1BQU10RDtJQUVOLGdDQUFnQztJQUNoQ3VELFlBQVk7UUFDVixNQUFNdkQ7SUFDUixHQUFHc0Qsa0JBQWtCLEtBQUssS0FBSztBQUNqQztBQUtBLDJCQUEyQjtBQUNIIiwic291cmNlcyI6WyIvaG9tZS9sZmcvR2l0L01hZHRyaXBzL3NyYy9saWIvbm9zdHIvTm9zdHJTb2NpYWxHcmFwaEZldGNoZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgU2ltcGxlUG9vbCwgbmlwMTksIEV2ZW50IH0gZnJvbSAnbm9zdHItdG9vbHMnO1xuaW1wb3J0IHsgd3JpdGVGaWxlLCByZWFkRmlsZSwgbWtkaXIgfSBmcm9tICdmcy9wcm9taXNlcyc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCB7IE5PU1RSX0NPTkZJRywgTm9kZVR5cGUgfSBmcm9tICcuL2NvbmZpZyc7XG5cbi8vIEludGVyZmFjZSBmb3IgZ3JhcGggdmlzdWFsaXphdGlvbiBzdHJ1Y3R1cmVcbmludGVyZmFjZSBWaXNOb2RlIHtcbiAgaWQ6IHN0cmluZztcbiAgbmFtZT86IHN0cmluZztcbiAgdHlwZTogTm9kZVR5cGU7XG4gIG5wdWI6IHN0cmluZztcbiAgcGljdHVyZT86IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIFZpc0xpbmsge1xuICBzb3VyY2U6IHN0cmluZztcbiAgdGFyZ2V0OiBzdHJpbmc7XG4gIHZhbHVlOiBudW1iZXI7XG4gIHR5cGU6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIFZpc0dyYXBoIHtcbiAgbm9kZXM6IFZpc05vZGVbXTtcbiAgbGlua3M6IFZpc0xpbmtbXTtcbiAgdGltZXN0YW1wOiBudW1iZXI7XG59XG5cbi8vIEludGVyZmFjZXMgZm9yIG91ciBkYXRhIHN0cnVjdHVyZXNcbmludGVyZmFjZSBTb2NpYWxHcmFwaERhdGEge1xuICBsYXN0VXBkYXRlZDogbnVtYmVyO1xuICBtZW1iZXJzOiB7XG4gICAgW3B1YmtleTogc3RyaW5nXToge1xuICAgICAgZm9sbG93czogc3RyaW5nW107XG4gICAgICBmb2xsb3dlcnM6IHN0cmluZ1tdO1xuICAgICAgbWVudGlvbnM6IHN0cmluZ1tdO1xuICAgICAgemFwczoge1xuICAgICAgICB0YXJnZXQ6IHN0cmluZztcbiAgICAgICAgYW1vdW50OiBudW1iZXI7XG4gICAgICAgIHRpbWVzdGFtcDogbnVtYmVyO1xuICAgICAgfVtdO1xuICAgICAgbGlrZXM6IHN0cmluZ1tdO1xuICAgICAgcmVwb3N0czogc3RyaW5nW107XG4gICAgICBtZXRhZGF0YT86IHtcbiAgICAgICAgbmFtZT86IHN0cmluZztcbiAgICAgICAgZGlzcGxheU5hbWU/OiBzdHJpbmc7XG4gICAgICAgIHBpY3R1cmU/OiBzdHJpbmc7XG4gICAgICAgIGFib3V0Pzogc3RyaW5nO1xuICAgICAgICBuaXAwNT86IHN0cmluZztcbiAgICAgIH07XG4gICAgfVxuICB9O1xufVxuXG5pbnRlcmZhY2UgS25vd25OcHVic0RhdGEge1xuICBsYXN0VXBkYXRlZDogbnVtYmVyO1xuICBucHViczoge1xuICAgIFtwdWJrZXk6IHN0cmluZ106IHtcbiAgICAgIGdyb3VwOiAnZnJlZU1hZGVpcmEnIHwgJ2FnZW5jeScgfCAnb3RoZXInO1xuICAgICAgZmlyc3RTZWVuOiBudW1iZXI7XG4gICAgICBsYXN0U2VlbjogbnVtYmVyO1xuICAgIH1cbiAgfTtcbn1cblxuLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGNvbnZlcnQgbnB1YiB0byBoZXggcHVia2V5XG5mdW5jdGlvbiBucHViVG9IZXgobnB1Yjogc3RyaW5nKTogc3RyaW5nIHwgbnVsbCB7XG4gIGlmICghbnB1YiB8fCAhbnB1Yi5zdGFydHNXaXRoKCducHViMScpKSByZXR1cm4gbnVsbDtcbiAgXG4gIHRyeSB7XG4gICAgY29uc3QgcmVzdWx0ID0gbmlwMTkuZGVjb2RlKG5wdWIpO1xuICAgIHJldHVybiByZXN1bHQudHlwZSA9PT0gJ25wdWInID8gcmVzdWx0LmRhdGEgOiBudWxsO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBkZWNvZGUgbnB1YjonLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGNvbnZlcnQgaGV4IHB1YmtleSB0byBucHViXG5mdW5jdGlvbiBoZXhUb05wdWIoaGV4OiBzdHJpbmcpOiBzdHJpbmcgfCBudWxsIHtcbiAgaWYgKCFoZXgpIHJldHVybiBudWxsO1xuICBcbiAgdHJ5IHtcbiAgICByZXR1cm4gbmlwMTkubnB1YkVuY29kZShoZXgpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBlbmNvZGUgaGV4IHRvIG5wdWI6JywgZXJyb3IpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbi8vIEhlbHBlciB0byBlbnN1cmUgb3VyIGRhdGEgZGlyZWN0b3JpZXMgZXhpc3RcbmFzeW5jIGZ1bmN0aW9uIGVuc3VyZURhdGFEaXJlY3RvcmllcygpIHtcbiAgdHJ5IHtcbiAgICBhd2FpdCBta2RpcihwYXRoLmRpcm5hbWUoTk9TVFJfQ09ORklHLnNvY2lhbEdyYXBoRmlsZSksIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBkYXRhIGRpcmVjdG9yeTonLCBlcnIpO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBhd2FpdCByZWFkRmlsZShOT1NUUl9DT05GSUcuc29jaWFsR3JhcGhGaWxlKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAvLyBJbml0aWFsaXplIGVtcHR5IHNvY2lhbCBncmFwaCBmaWxlXG4gICAgY29uc3QgaW5pdGlhbERhdGE6IFNvY2lhbEdyYXBoRGF0YSA9IHtcbiAgICAgIGxhc3RVcGRhdGVkOiBEYXRlLm5vdygpLFxuICAgICAgbWVtYmVyczoge31cbiAgICB9O1xuICAgIGF3YWl0IHdyaXRlRmlsZShOT1NUUl9DT05GSUcuc29jaWFsR3JhcGhGaWxlLCBKU09OLnN0cmluZ2lmeShpbml0aWFsRGF0YSwgbnVsbCwgMikpO1xuICB9XG4gIFxuICB0cnkge1xuICAgIGF3YWl0IHJlYWRGaWxlKE5PU1RSX0NPTkZJRy5rbm93blB1YmtleXNGaWxlKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAvLyBJbml0aWFsaXplIGVtcHR5IGtub3duIG5wdWJzIGZpbGUgd2l0aCBvdXIgaW5pdGlhbCBrbm93biBwdWJrZXlzXG4gICAgY29uc3QgaW5pdGlhbEtub3duTnB1YnM6IEtub3duTnB1YnNEYXRhID0ge1xuICAgICAgbGFzdFVwZGF0ZWQ6IERhdGUubm93KCksXG4gICAgICBucHViczoge31cbiAgICB9O1xuICAgIFxuICAgIC8vIEFkZCBpbml0aWFsIG5wdWJzIGZyb20gY29uZmlnXG4gICAgZm9yIChjb25zdCBucHViIG9mIE5PU1RSX0NPTkZJRy5pbml0aWFsS25vd25OcHVicykge1xuICAgICAgY29uc3QgaGV4ID0gbnB1YlRvSGV4KG5wdWIpO1xuICAgICAgaWYgKGhleCkge1xuICAgICAgICAvLyBEZXRlcm1pbmUgdGhlIGdyb3VwIGJhc2VkIG9uIG5wdWJcbiAgICAgICAgbGV0IGdyb3VwOiAnZnJlZU1hZGVpcmEnIHwgJ2FnZW5jeScgfCAnb3RoZXInID0gJ290aGVyJztcbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIGlmIGl0J3MgdGhlIEZyZWUgTWFkZWlyYSBucHViXG4gICAgICAgIGlmIChucHViID09PSAnbnB1YjFldGdxY2o5Z2M2eWF4dHR1d3U5ZXFnczN5bnQyZHphdWR2d25yc3NybjJ6ZHQydXNlYWFzZmo4bjZlJykge1xuICAgICAgICAgIGdyb3VwID0gJ2ZyZWVNYWRlaXJhJztcbiAgICAgICAgfSBcbiAgICAgICAgLy8gQ2hlY2sgaWYgaXQncyB0aGUgTWFkdHJpcHMgYWdlbmN5IG5wdWJcbiAgICAgICAgZWxzZSBpZiAobnB1YiA9PT0gJ25wdWIxZHhkMDJrY2poZ3BreXJ4NjBxbmtkNmo0MmttYzcydTVsdW0wcnAydWQ4eDV6ZmhuazR6c2NqajZoaCcpIHtcbiAgICAgICAgICBncm91cCA9ICdhZ2VuY3knO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpbml0aWFsS25vd25OcHVicy5ucHVic1toZXhdID0ge1xuICAgICAgICAgIGdyb3VwLFxuICAgICAgICAgIGZpcnN0U2VlbjogRGF0ZS5ub3coKSxcbiAgICAgICAgICBsYXN0U2VlbjogRGF0ZS5ub3coKVxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBhd2FpdCB3cml0ZUZpbGUoTk9TVFJfQ09ORklHLmtub3duUHVia2V5c0ZpbGUsIEpTT04uc3RyaW5naWZ5KGluaXRpYWxLbm93bk5wdWJzLCBudWxsLCAyKSk7XG4gIH1cbn1cblxuLy8gTG9hZCBjdXJyZW50IHNvY2lhbCBncmFwaCBkYXRhXG5hc3luYyBmdW5jdGlvbiBsb2FkU29jaWFsR3JhcGhEYXRhKCk6IFByb21pc2U8U29jaWFsR3JhcGhEYXRhPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlYWRGaWxlKE5PU1RSX0NPTkZJRy5zb2NpYWxHcmFwaEZpbGUsICd1dGY4Jyk7XG4gICAgcmV0dXJuIEpTT04ucGFyc2UoZGF0YSkgYXMgU29jaWFsR3JhcGhEYXRhO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGxvYWRpbmcgc29jaWFsIGdyYXBoIGRhdGE6JywgZXJyb3IpO1xuICAgIHJldHVybiB7IGxhc3RVcGRhdGVkOiAwLCBtZW1iZXJzOiB7fSB9O1xuICB9XG59XG5cbi8vIExvYWQgY3VycmVudCBrbm93biBucHVicyBkYXRhXG5hc3luYyBmdW5jdGlvbiBsb2FkS25vd25OcHVic0RhdGEoKTogUHJvbWlzZTxLbm93bk5wdWJzRGF0YT4ge1xuICB0cnkge1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZWFkRmlsZShOT1NUUl9DT05GSUcua25vd25QdWJrZXlzRmlsZSwgJ3V0ZjgnKTtcbiAgICByZXR1cm4gSlNPTi5wYXJzZShkYXRhKSBhcyBLbm93bk5wdWJzRGF0YTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBsb2FkaW5nIGtub3duIG5wdWJzIGRhdGE6JywgZXJyb3IpO1xuICAgIHJldHVybiB7IGxhc3RVcGRhdGVkOiAwLCBucHViczoge30gfTtcbiAgfVxufVxuXG4vLyBTYXZlIHVwZGF0ZWQgc29jaWFsIGdyYXBoIGRhdGFcbmFzeW5jIGZ1bmN0aW9uIHNhdmVTb2NpYWxHcmFwaERhdGEoZGF0YTogU29jaWFsR3JhcGhEYXRhKSB7XG4gIHRyeSB7XG4gICAgZGF0YS5sYXN0VXBkYXRlZCA9IERhdGUubm93KCk7XG4gICAgYXdhaXQgd3JpdGVGaWxlKE5PU1RSX0NPTkZJRy5zb2NpYWxHcmFwaEZpbGUsIEpTT04uc3RyaW5naWZ5KGRhdGEsIG51bGwsIDIpKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzYXZpbmcgc29jaWFsIGdyYXBoIGRhdGE6JywgZXJyb3IpO1xuICB9XG59XG5cbi8vIFNhdmUgdXBkYXRlZCBrbm93biBucHVicyBkYXRhXG5hc3luYyBmdW5jdGlvbiBzYXZlS25vd25OcHVic0RhdGEoZGF0YTogS25vd25OcHVic0RhdGEpIHtcbiAgdHJ5IHtcbiAgICBkYXRhLmxhc3RVcGRhdGVkID0gRGF0ZS5ub3coKTtcbiAgICBhd2FpdCB3cml0ZUZpbGUoTk9TVFJfQ09ORklHLmtub3duUHVia2V5c0ZpbGUsIEpTT04uc3RyaW5naWZ5KGRhdGEsIG51bGwsIDIpKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzYXZpbmcga25vd24gbnB1YnMgZGF0YTonLCBlcnJvcik7XG4gIH1cbn1cblxuLy8gQWRkIGEgbmV3IG5wdWIgdG8gb3VyIGtub3duIG5wdWJzXG5hc3luYyBmdW5jdGlvbiBhZGRLbm93bk5wdWIoXG4gIG5wdWI6IHN0cmluZywgXG4gIGdyb3VwOiAnZnJlZU1hZGVpcmEnIHwgJ2FnZW5jeScgfCAnb3RoZXInID0gJ290aGVyJ1xuKTogUHJvbWlzZTxib29sZWFuPiB7XG4gIGNvbnN0IGhleCA9IG5wdWJUb0hleChucHViKTtcbiAgaWYgKCFoZXgpIHJldHVybiBmYWxzZTtcbiAgXG4gIGNvbnN0IGtub3duTnB1YnMgPSBhd2FpdCBsb2FkS25vd25OcHVic0RhdGEoKTtcbiAgXG4gIC8vIEFkZCBvciB1cGRhdGUgdGhlIG5wdWJcbiAga25vd25OcHVicy5ucHVic1toZXhdID0ge1xuICAgIGdyb3VwLFxuICAgIGZpcnN0U2Vlbjoga25vd25OcHVicy5ucHVic1toZXhdPy5maXJzdFNlZW4gfHwgRGF0ZS5ub3coKSxcbiAgICBsYXN0U2VlbjogRGF0ZS5ub3coKVxuICB9O1xuICBcbiAgYXdhaXQgc2F2ZUtub3duTnB1YnNEYXRhKGtub3duTnB1YnMpO1xuICByZXR1cm4gdHJ1ZTtcbn1cblxuLy8gRmV0Y2ggcHJvZmlsZSBtZXRhZGF0YSAoa2luZDowKSBmb3IgYSBzcGVjaWZpYyBwdWJrZXlcbmFzeW5jIGZ1bmN0aW9uIGZldGNoUHJvZmlsZU1ldGFkYXRhKHB1YmtleTogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcbiAgY29uc3QgcG9vbCA9IG5ldyBTaW1wbGVQb29sKCk7XG4gIGxldCBtZXRhZGF0YSA9IG51bGw7XG4gIFxuICB0cnkge1xuICAgIC8vIFVzaW5nIHRoZSBzdWJzY3JpYmVNYW55IG1ldGhvZCBpbnN0ZWFkIG9mIGxpc3Qgc2luY2UgbGlzdCBpcyBub3QgYXZhaWxhYmxlIGluIHRoaXMgdmVyc2lvblxuICAgIGNvbnN0IG1ldGFkYXRhUHJvbWlzZSA9IG5ldyBQcm9taXNlPGFueT4oKHJlc29sdmUpID0+IHtcbiAgICAgIGxldCBmb3VuZE1ldGFkYXRhOiBhbnkgPSBudWxsO1xuICAgICAgXG4gICAgICBjb25zdCBzdWJzY3JpcHRpb24gPSBwb29sLnN1YnNjcmliZU1hbnkoTk9TVFJfQ09ORklHLmRlZmF1bHRSZWxheXMsIFt7XG4gICAgICAgIGtpbmRzOiBbMF0sIC8vIG1ldGFkYXRhXG4gICAgICAgIGF1dGhvcnM6IFtwdWJrZXldLFxuICAgICAgICBsaW1pdDogMVxuICAgICAgfV0sIHtcbiAgICAgICAgb25ldmVudChldmVudDogRXZlbnQpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgZm91bmRNZXRhZGF0YSA9IEpTT04ucGFyc2UoZXZlbnQuY29udGVudCk7XG4gICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHBhcnNlIHByb2ZpbGUgbWV0YWRhdGE6JywgZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBvbmVvc2UoKSB7XG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBzdWJzY3JpcHRpb24uY2xvc2UoKTtcbiAgICAgICAgICAgIHJlc29sdmUoZm91bmRNZXRhZGF0YSk7XG4gICAgICAgICAgfSwgMTAwMCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgXG4gICAgICAvLyBTZXQgYSB0aW1lb3V0IGluIGNhc2Ugd2UgZG9uJ3QgZ2V0IEVPU0VcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBzdWJzY3JpcHRpb24uY2xvc2UoKTtcbiAgICAgICAgcmVzb2x2ZShmb3VuZE1ldGFkYXRhKTtcbiAgICAgIH0sIE5PU1RSX0NPTkZJRy5mZXRjaFRpbWVvdXRNcyk7XG4gICAgfSk7XG4gICAgXG4gICAgbWV0YWRhdGEgPSBhd2FpdCBtZXRhZGF0YVByb21pc2U7XG4gICAgcG9vbC5jbG9zZShOT1NUUl9DT05GSUcuZGVmYXVsdFJlbGF5cyk7XG4gICAgcmV0dXJuIG1ldGFkYXRhO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHByb2ZpbGUgbWV0YWRhdGE6JywgZXJyb3IpO1xuICAgIHBvb2wuY2xvc2UoTk9TVFJfQ09ORklHLmRlZmF1bHRSZWxheXMpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbi8vIEZldGNoIGZvbGxvd3MgKGtpbmQ6MykgZXZlbnRzIGZyb20gYSBzcGVjaWZpYyBwdWJrZXlcbmFzeW5jIGZ1bmN0aW9uIGZldGNoRm9sbG93cyhwdWJrZXk6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgY29uc3QgcG9vbCA9IG5ldyBTaW1wbGVQb29sKCk7XG4gIGNvbnN0IGZvbGxvd3M6IHN0cmluZ1tdID0gW107XG4gIFxuICB0cnkge1xuICAgIC8vIENyZWF0ZSBhIHByb21pc2UgdG8gaGFuZGxlIHRoZSBzdWJzY3JpcHRpb25cbiAgICBjb25zdCBmb2xsb3dzUHJvbWlzZSA9IG5ldyBQcm9taXNlPHN0cmluZ1tdPigocmVzb2x2ZSkgPT4ge1xuICAgICAgY29uc3Qgc3Vic2NyaXB0aW9uID0gcG9vbC5zdWJzY3JpYmVNYW55KE5PU1RSX0NPTkZJRy5kZWZhdWx0UmVsYXlzLCBbXG4gICAgICAgIHtcbiAgICAgICAgICBraW5kczogWzNdLCAvLyBjb250YWN0cy9mb2xsb3dzXG4gICAgICAgICAgYXV0aG9yczogW3B1YmtleV0sXG4gICAgICAgICAgbGltaXQ6IDEgLy8gV2UganVzdCBuZWVkIHRoZSBtb3N0IHJlY2VudCBvbmVcbiAgICAgICAgfVxuICAgICAgXSwge1xuICAgICAgICBvbmV2ZW50KGV2ZW50OiBFdmVudCkge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBFeHRyYWN0ICdwJyB0YWdzIHdoaWNoIGNvbnRhaW4gZm9sbG93ZWQgcHVia2V5c1xuICAgICAgICAgICAgY29uc3QgZm9sbG93ZWRQdWJrZXlzID0gZXZlbnQudGFnc1xuICAgICAgICAgICAgICAuZmlsdGVyKHRhZyA9PiB0YWdbMF0gPT09ICdwJylcbiAgICAgICAgICAgICAgLm1hcCh0YWcgPT4gdGFnWzFdKTtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICBmb2xsb3dzLnB1c2goLi4uZm9sbG93ZWRQdWJrZXlzKTtcbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gcGFyc2UgZm9sbG93czonLCBlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIG9uZW9zZSgpIHtcbiAgICAgICAgICAvLyBBZnRlciBFT1NFIChFbmQgb2YgU3RvcmVkIEV2ZW50cylcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHN1YnNjcmlwdGlvbi5jbG9zZSgpO1xuICAgICAgICAgICAgcmVzb2x2ZShmb2xsb3dzKTtcbiAgICAgICAgICB9LCAxMDAwKTsgLy8gR2l2ZSBpdCBhIHNlY29uZCB0byByZWNlaXZlIGFueSBsYXN0IGV2ZW50c1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgLy8gU2V0IGEgdGltZW91dCBpbiBjYXNlIHdlIGRvbid0IGdldCBFT1NFXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgc3Vic2NyaXB0aW9uLmNsb3NlKCk7XG4gICAgICAgIHJlc29sdmUoZm9sbG93cyk7XG4gICAgICB9LCBOT1NUUl9DT05GSUcuZmV0Y2hUaW1lb3V0TXMpO1xuICAgIH0pO1xuICAgIFxuICAgIC8vIFdhaXQgZm9yIHRoZSBwcm9taXNlIHRvIHJlc29sdmVcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBmb2xsb3dzUHJvbWlzZTtcbiAgICBwb29sLmNsb3NlKE5PU1RSX0NPTkZJRy5kZWZhdWx0UmVsYXlzKTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICAgIFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGZvbGxvd3M6JywgZXJyb3IpO1xuICAgIHBvb2wuY2xvc2UoTk9TVFJfQ09ORklHLmRlZmF1bHRSZWxheXMpO1xuICAgIHJldHVybiBbXTtcbiAgfVxufVxuXG4vLyBGZXRjaCBpbnRlcmFjdGlvbnMgKG1lbnRpb25zLCBsaWtlcywgcmVwb3N0cywgemFwcykgcmVsYXRlZCB0byBhIHB1YmtleVxuYXN5bmMgZnVuY3Rpb24gZmV0Y2hJbnRlcmFjdGlvbnMocHVia2V5OiBzdHJpbmcsIHNpbmNlOiBudW1iZXIgPSAwKSB7XG4gIGNvbnN0IHBvb2wgPSBuZXcgU2ltcGxlUG9vbCgpO1xuICBjb25zdCBpbnRlcmFjdGlvbnMgPSB7XG4gICAgbWVudGlvbnM6IFtdIGFzIHN0cmluZ1tdLFxuICAgIGxpa2VzOiBbXSBhcyBzdHJpbmdbXSxcbiAgICByZXBvc3RzOiBbXSBhcyBzdHJpbmdbXSxcbiAgICB6YXBzOiBbXSBhcyB7IHRhcmdldDogc3RyaW5nLCBhbW91bnQ6IG51bWJlciwgdGltZXN0YW1wOiBudW1iZXIgfVtdXG4gIH07XG4gIFxuICB0cnkge1xuICAgIC8vIENyZWF0ZSBhIHByb21pc2UgdG8gaGFuZGxlIHRoZSBzdWJzY3JpcHRpb25cbiAgICBjb25zdCBpbnRlcmFjdGlvbnNQcm9taXNlID0gbmV3IFByb21pc2U8dHlwZW9mIGludGVyYWN0aW9ucz4oKHJlc29sdmUpID0+IHtcbiAgICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9IHBvb2wuc3Vic2NyaWJlTWFueShOT1NUUl9DT05GSUcuZGVmYXVsdFJlbGF5cywgW1xuICAgICAgICB7XG4gICAgICAgICAga2luZHM6IFsxLCA2LCA3LCA5NzM1XSwgLy8gbm90ZXMsIHJlcG9zdHMsIGxpa2VzLCB6YXBzXG4gICAgICAgICAgJyNwJzogW3B1YmtleV0sIC8vIEV2ZW50cyB0aGF0IHJlZmVyZW5jZSB0aGlzIHB1YmtleVxuICAgICAgICAgIHNpbmNlOiBzaW5jZSA+IDAgPyBzaW5jZSA6IHVuZGVmaW5lZCxcbiAgICAgICAgICBsaW1pdDogTk9TVFJfQ09ORklHLm1heEV2ZW50c1BlclJlbGF5XG4gICAgICAgIH1cbiAgICAgIF0sIHtcbiAgICAgICAgb25ldmVudChldmVudDogRXZlbnQpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgc3dpdGNoIChldmVudC5raW5kKSB7XG4gICAgICAgICAgICAgIGNhc2UgMTogLy8gbm90ZS9wb3N0XG4gICAgICAgICAgICAgICAgLy8gQWRkIGF1dGhvciB0byBtZW50aW9uc1xuICAgICAgICAgICAgICAgIGludGVyYWN0aW9ucy5tZW50aW9ucy5wdXNoKGV2ZW50LnB1YmtleSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIGNhc2UgNjogLy8gcmVwb3N0XG4gICAgICAgICAgICAgICAgLy8gQWRkIGF1dGhvciB0byByZXBvc3RzXG4gICAgICAgICAgICAgICAgaW50ZXJhY3Rpb25zLnJlcG9zdHMucHVzaChldmVudC5wdWJrZXkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICBjYXNlIDc6IC8vIGxpa2UvcmVhY3Rpb25cbiAgICAgICAgICAgICAgICAvLyBBZGQgYXV0aG9yIHRvIGxpa2VzXG4gICAgICAgICAgICAgICAgaW50ZXJhY3Rpb25zLmxpa2VzLnB1c2goZXZlbnQucHVia2V5KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgY2FzZSA5NzM1OiAvLyB6YXBcbiAgICAgICAgICAgICAgICAvLyBUcnkgdG8gcGFyc2UgemFwIGFtb3VudCBmcm9tIHRhZ3NcbiAgICAgICAgICAgICAgICBjb25zdCBhbW91bnRUYWcgPSBldmVudC50YWdzLmZpbmQodGFnID0+IHRhZ1swXSA9PT0gJ2Ftb3VudCcpO1xuICAgICAgICAgICAgICAgIGlmIChhbW91bnRUYWcgJiYgYW1vdW50VGFnWzFdKSB7XG4gICAgICAgICAgICAgICAgICBjb25zdCBhbW91bnQgPSBwYXJzZUludChhbW91bnRUYWdbMV0sIDEwKTtcbiAgICAgICAgICAgICAgICAgIGlmICghaXNOYU4oYW1vdW50KSkge1xuICAgICAgICAgICAgICAgICAgICBpbnRlcmFjdGlvbnMuemFwcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IHB1YmtleSxcbiAgICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IGFtb3VudCxcbiAgICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IGV2ZW50LmNyZWF0ZWRfYXRcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBwYXJzZSBpbnRlcmFjdGlvbjonLCBlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIG9uZW9zZSgpIHtcbiAgICAgICAgICAvLyBBZnRlciBFT1NFIChFbmQgb2YgU3RvcmVkIEV2ZW50cylcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHN1YnNjcmlwdGlvbi5jbG9zZSgpO1xuICAgICAgICAgICAgcmVzb2x2ZShpbnRlcmFjdGlvbnMpO1xuICAgICAgICAgIH0sIDEwMDApOyAvLyBHaXZlIGl0IGEgc2Vjb25kIHRvIHJlY2VpdmUgYW55IGxhc3QgZXZlbnRzXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgXG4gICAgICAvLyBTZXQgYSB0aW1lb3V0IGluIGNhc2Ugd2UgZG9uJ3QgZ2V0IEVPU0VcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBzdWJzY3JpcHRpb24uY2xvc2UoKTtcbiAgICAgICAgcmVzb2x2ZShpbnRlcmFjdGlvbnMpO1xuICAgICAgfSwgTk9TVFJfQ09ORklHLmZldGNoVGltZW91dE1zKTtcbiAgICB9KTtcbiAgICBcbiAgICAvLyBXYWl0IGZvciB0aGUgcHJvbWlzZSB0byByZXNvbHZlXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgaW50ZXJhY3Rpb25zUHJvbWlzZTtcbiAgICBwb29sLmNsb3NlKE5PU1RSX0NPTkZJRy5kZWZhdWx0UmVsYXlzKTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICAgIFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGludGVyYWN0aW9uczonLCBlcnJvcik7XG4gICAgcG9vbC5jbG9zZShOT1NUUl9DT05GSUcuZGVmYXVsdFJlbGF5cyk7XG4gICAgcmV0dXJuIGludGVyYWN0aW9ucztcbiAgfVxufVxuXG4vLyBVcGRhdGUgc29jaWFsIGdyYXBoIHdpdGggbmV3IGRhdGFcbmFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVNvY2lhbEdyYXBoKCkge1xuICAvLyBFbnN1cmUgZGF0YSBkaXJlY3RvcmllcyBleGlzdFxuICBhd2FpdCBlbnN1cmVEYXRhRGlyZWN0b3JpZXMoKTtcbiAgXG4gIC8vIExvYWQgY3VycmVudCBkYXRhXG4gIGNvbnN0IHNvY2lhbEdyYXBoID0gYXdhaXQgbG9hZFNvY2lhbEdyYXBoRGF0YSgpO1xuICBjb25zdCBrbm93bk5wdWJzID0gYXdhaXQgbG9hZEtub3duTnB1YnNEYXRhKCk7XG4gIFxuICAvLyBHZXQgRnJlZSBNYWRlaXJhIG1lbWJlcnMgKHRob3NlIHdpdGggZ3JvdXAgJ2ZyZWVNYWRlaXJhJylcbiAgY29uc3QgZnJlZU1hZGVpcmFNZW1iZXJzID0gT2JqZWN0LmVudHJpZXMoa25vd25OcHVicy5ucHVicylcbiAgICAuZmlsdGVyKChbXywgZGF0YV0pID0+IGRhdGEuZ3JvdXAgPT09ICdmcmVlTWFkZWlyYScpXG4gICAgLm1hcCgoW3B1YmtleV0pID0+IHB1YmtleSk7XG4gICAgXG4gIC8vIEdldCBhZ2VuY3kgcHVia2V5c1xuICBjb25zdCBhZ2VuY3lQdWJrZXlzID0gT2JqZWN0LmVudHJpZXMoa25vd25OcHVicy5ucHVicylcbiAgICAuZmlsdGVyKChbXywgZGF0YV0pID0+IGRhdGEuZ3JvdXAgPT09ICdhZ2VuY3knKVxuICAgIC5tYXAoKFtwdWJrZXldKSA9PiBwdWJrZXkpO1xuICBcbiAgLy8gUHJvY2VzcyBGcmVlIE1hZGVpcmEgbWVtYmVyc1xuICBmb3IgKGNvbnN0IHB1YmtleSBvZiBmcmVlTWFkZWlyYU1lbWJlcnMpIHtcbiAgICBjb25zb2xlLmxvZyhgUHJvY2Vzc2luZyBGcmVlIE1hZGVpcmEgbWVtYmVyOiAke3B1YmtleX1gKTtcbiAgICBcbiAgICAvLyBJbml0aWFsaXplIG1lbWJlciBkYXRhIGlmIG5vdCBleGlzdHNcbiAgICBpZiAoIXNvY2lhbEdyYXBoLm1lbWJlcnNbcHVia2V5XSkge1xuICAgICAgc29jaWFsR3JhcGgubWVtYmVyc1twdWJrZXldID0ge1xuICAgICAgICBmb2xsb3dzOiBbXSxcbiAgICAgICAgZm9sbG93ZXJzOiBbXSxcbiAgICAgICAgbWVudGlvbnM6IFtdLFxuICAgICAgICB6YXBzOiBbXSxcbiAgICAgICAgbGlrZXM6IFtdLFxuICAgICAgICByZXBvc3RzOiBbXVxuICAgICAgfTtcbiAgICB9XG4gICAgXG4gICAgLy8gR2V0IHByb2ZpbGUgbWV0YWRhdGFcbiAgICBjb25zdCBtZXRhZGF0YSA9IGF3YWl0IGZldGNoUHJvZmlsZU1ldGFkYXRhKHB1YmtleSk7XG4gICAgaWYgKG1ldGFkYXRhKSB7XG4gICAgICBzb2NpYWxHcmFwaC5tZW1iZXJzW3B1YmtleV0ubWV0YWRhdGEgPSB7XG4gICAgICAgIG5hbWU6IG1ldGFkYXRhLm5hbWUsXG4gICAgICAgIGRpc3BsYXlOYW1lOiBtZXRhZGF0YS5kaXNwbGF5X25hbWUgfHwgbWV0YWRhdGEuZGlzcGxheU5hbWUsXG4gICAgICAgIHBpY3R1cmU6IG1ldGFkYXRhLnBpY3R1cmUsXG4gICAgICAgIGFib3V0OiBtZXRhZGF0YS5hYm91dCxcbiAgICAgICAgbmlwMDU6IG1ldGFkYXRhLm5pcDA1XG4gICAgICB9O1xuICAgIH1cbiAgICBcbiAgICAvLyBHZXQgZm9sbG93c1xuICAgIGNvbnN0IGZvbGxvd3MgPSBhd2FpdCBmZXRjaEZvbGxvd3MocHVia2V5KTtcbiAgICBzb2NpYWxHcmFwaC5tZW1iZXJzW3B1YmtleV0uZm9sbG93cyA9IGZvbGxvd3M7XG4gICAgXG4gICAgLy8gQWRkIG5ldyBwdWJrZXlzIHRvIGtub3duIG5wdWJzXG4gICAgZm9yIChjb25zdCBmb2xsb3dlZFB1YmtleSBvZiBmb2xsb3dzKSB7XG4gICAgICBpZiAoIWtub3duTnB1YnMubnB1YnNbZm9sbG93ZWRQdWJrZXldKSB7XG4gICAgICAgIGtub3duTnB1YnMubnB1YnNbZm9sbG93ZWRQdWJrZXldID0ge1xuICAgICAgICAgIGdyb3VwOiAnb3RoZXInLFxuICAgICAgICAgIGZpcnN0U2VlbjogRGF0ZS5ub3coKSxcbiAgICAgICAgICBsYXN0U2VlbjogRGF0ZS5ub3coKVxuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAga25vd25OcHVicy5ucHVic1tmb2xsb3dlZFB1YmtleV0ubGFzdFNlZW4gPSBEYXRlLm5vdygpO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBJbml0aWFsaXplIGZvbGxvd2VkIG1lbWJlciBkYXRhIGlmIG5vdCBleGlzdHNcbiAgICAgIGlmICghc29jaWFsR3JhcGgubWVtYmVyc1tmb2xsb3dlZFB1YmtleV0pIHtcbiAgICAgICAgc29jaWFsR3JhcGgubWVtYmVyc1tmb2xsb3dlZFB1YmtleV0gPSB7XG4gICAgICAgICAgZm9sbG93czogW10sXG4gICAgICAgICAgZm9sbG93ZXJzOiBbXSxcbiAgICAgICAgICBtZW50aW9uczogW10sXG4gICAgICAgICAgemFwczogW10sXG4gICAgICAgICAgbGlrZXM6IFtdLFxuICAgICAgICAgIHJlcG9zdHM6IFtdXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEFkZCBmb2xsb3dlclxuICAgICAgaWYgKCFzb2NpYWxHcmFwaC5tZW1iZXJzW2ZvbGxvd2VkUHVia2V5XS5mb2xsb3dlcnMuaW5jbHVkZXMocHVia2V5KSkge1xuICAgICAgICBzb2NpYWxHcmFwaC5tZW1iZXJzW2ZvbGxvd2VkUHVia2V5XS5mb2xsb3dlcnMucHVzaChwdWJrZXkpO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBGZXRjaCBtZXRhZGF0YSBmb3IgZm9sbG93ZWQgYWNjb3VudHMgaWYgbmVlZGVkXG4gICAgZm9yIChjb25zdCBmb2xsb3dlZFB1YmtleSBvZiBmb2xsb3dzKSB7XG4gICAgICBpZiAoIXNvY2lhbEdyYXBoLm1lbWJlcnNbZm9sbG93ZWRQdWJrZXldLm1ldGFkYXRhKSB7XG4gICAgICAgIGNvbnN0IGZvbGxvd2VkTWV0YWRhdGEgPSBhd2FpdCBmZXRjaFByb2ZpbGVNZXRhZGF0YShmb2xsb3dlZFB1YmtleSk7XG4gICAgICAgIGlmIChmb2xsb3dlZE1ldGFkYXRhKSB7XG4gICAgICAgICAgc29jaWFsR3JhcGgubWVtYmVyc1tmb2xsb3dlZFB1YmtleV0ubWV0YWRhdGEgPSB7XG4gICAgICAgICAgICBuYW1lOiBmb2xsb3dlZE1ldGFkYXRhLm5hbWUsXG4gICAgICAgICAgICBkaXNwbGF5TmFtZTogZm9sbG93ZWRNZXRhZGF0YS5kaXNwbGF5X25hbWUgfHwgZm9sbG93ZWRNZXRhZGF0YS5kaXNwbGF5TmFtZSxcbiAgICAgICAgICAgIHBpY3R1cmU6IGZvbGxvd2VkTWV0YWRhdGEucGljdHVyZSxcbiAgICAgICAgICAgIGFib3V0OiBmb2xsb3dlZE1ldGFkYXRhLmFib3V0LFxuICAgICAgICAgICAgbmlwMDU6IGZvbGxvd2VkTWV0YWRhdGEubmlwMDVcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG4gIFxuICAvLyBQcm9jZXNzIGFnZW5jeSBpbnRlcmFjdGlvbnNcbiAgZm9yIChjb25zdCBwdWJrZXkgb2YgYWdlbmN5UHVia2V5cykge1xuICAgIGNvbnNvbGUubG9nKGBQcm9jZXNzaW5nIGFnZW5jeSBhY2NvdW50OiAke3B1YmtleX1gKTtcbiAgICBcbiAgICAvLyBJbml0aWFsaXplIG1lbWJlciBkYXRhIGlmIG5vdCBleGlzdHNcbiAgICBpZiAoIXNvY2lhbEdyYXBoLm1lbWJlcnNbcHVia2V5XSkge1xuICAgICAgc29jaWFsR3JhcGgubWVtYmVyc1twdWJrZXldID0ge1xuICAgICAgICBmb2xsb3dzOiBbXSxcbiAgICAgICAgZm9sbG93ZXJzOiBbXSxcbiAgICAgICAgbWVudGlvbnM6IFtdLFxuICAgICAgICB6YXBzOiBbXSxcbiAgICAgICAgbGlrZXM6IFtdLFxuICAgICAgICByZXBvc3RzOiBbXVxuICAgICAgfTtcbiAgICB9XG4gICAgXG4gICAgLy8gR2V0IHByb2ZpbGUgbWV0YWRhdGFcbiAgICBjb25zdCBtZXRhZGF0YSA9IGF3YWl0IGZldGNoUHJvZmlsZU1ldGFkYXRhKHB1YmtleSk7XG4gICAgaWYgKG1ldGFkYXRhKSB7XG4gICAgICBzb2NpYWxHcmFwaC5tZW1iZXJzW3B1YmtleV0ubWV0YWRhdGEgPSB7XG4gICAgICAgIG5hbWU6IG1ldGFkYXRhLm5hbWUsXG4gICAgICAgIGRpc3BsYXlOYW1lOiBtZXRhZGF0YS5kaXNwbGF5X25hbWUgfHwgbWV0YWRhdGEuZGlzcGxheU5hbWUsXG4gICAgICAgIHBpY3R1cmU6IG1ldGFkYXRhLnBpY3R1cmUsXG4gICAgICAgIGFib3V0OiBtZXRhZGF0YS5hYm91dCxcbiAgICAgICAgbmlwMDU6IG1ldGFkYXRhLm5pcDA1XG4gICAgICB9O1xuICAgIH1cbiAgICBcbiAgICAvLyBDYWxjdWxhdGUgc2luY2UgdGltZXN0YW1wICgxIHdlZWsgYWdvKVxuICAgIGNvbnN0IG9uZVdlZWtBZ28gPSBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKSAtICg3ICogMjQgKiA2MCAqIDYwKTtcbiAgICBcbiAgICAvLyBHZXQgaW50ZXJhY3Rpb25zXG4gICAgY29uc3QgaW50ZXJhY3Rpb25zID0gYXdhaXQgZmV0Y2hJbnRlcmFjdGlvbnMocHVia2V5LCBvbmVXZWVrQWdvKTtcbiAgICBcbiAgICAvLyBVcGRhdGUgaW50ZXJhY3Rpb25zXG4gICAgZm9yIChjb25zdCBtZW50aW9uUHVia2V5IG9mIGludGVyYWN0aW9ucy5tZW50aW9ucykge1xuICAgICAgaWYgKCFzb2NpYWxHcmFwaC5tZW1iZXJzW3B1YmtleV0ubWVudGlvbnMuaW5jbHVkZXMobWVudGlvblB1YmtleSkpIHtcbiAgICAgICAgc29jaWFsR3JhcGgubWVtYmVyc1twdWJrZXldLm1lbnRpb25zLnB1c2gobWVudGlvblB1YmtleSk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEFkZCB0byBrbm93biBucHVic1xuICAgICAgaWYgKCFrbm93bk5wdWJzLm5wdWJzW21lbnRpb25QdWJrZXldKSB7XG4gICAgICAgIGtub3duTnB1YnMubnB1YnNbbWVudGlvblB1YmtleV0gPSB7XG4gICAgICAgICAgZ3JvdXA6ICdvdGhlcicsXG4gICAgICAgICAgZmlyc3RTZWVuOiBEYXRlLm5vdygpLFxuICAgICAgICAgIGxhc3RTZWVuOiBEYXRlLm5vdygpXG4gICAgICAgIH07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBrbm93bk5wdWJzLm5wdWJzW21lbnRpb25QdWJrZXldLmxhc3RTZWVuID0gRGF0ZS5ub3coKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgZm9yIChjb25zdCBsaWtlUHVia2V5IG9mIGludGVyYWN0aW9ucy5saWtlcykge1xuICAgICAgaWYgKCFzb2NpYWxHcmFwaC5tZW1iZXJzW3B1YmtleV0ubGlrZXMuaW5jbHVkZXMobGlrZVB1YmtleSkpIHtcbiAgICAgICAgc29jaWFsR3JhcGgubWVtYmVyc1twdWJrZXldLmxpa2VzLnB1c2gobGlrZVB1YmtleSk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEFkZCB0byBrbm93biBucHVic1xuICAgICAgaWYgKCFrbm93bk5wdWJzLm5wdWJzW2xpa2VQdWJrZXldKSB7XG4gICAgICAgIGtub3duTnB1YnMubnB1YnNbbGlrZVB1YmtleV0gPSB7XG4gICAgICAgICAgZ3JvdXA6ICdvdGhlcicsXG4gICAgICAgICAgZmlyc3RTZWVuOiBEYXRlLm5vdygpLFxuICAgICAgICAgIGxhc3RTZWVuOiBEYXRlLm5vdygpXG4gICAgICAgIH07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBrbm93bk5wdWJzLm5wdWJzW2xpa2VQdWJrZXldLmxhc3RTZWVuID0gRGF0ZS5ub3coKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgZm9yIChjb25zdCByZXBvc3RQdWJrZXkgb2YgaW50ZXJhY3Rpb25zLnJlcG9zdHMpIHtcbiAgICAgIGlmICghc29jaWFsR3JhcGgubWVtYmVyc1twdWJrZXldLnJlcG9zdHMuaW5jbHVkZXMocmVwb3N0UHVia2V5KSkge1xuICAgICAgICBzb2NpYWxHcmFwaC5tZW1iZXJzW3B1YmtleV0ucmVwb3N0cy5wdXNoKHJlcG9zdFB1YmtleSk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEFkZCB0byBrbm93biBucHVic1xuICAgICAgaWYgKCFrbm93bk5wdWJzLm5wdWJzW3JlcG9zdFB1YmtleV0pIHtcbiAgICAgICAga25vd25OcHVicy5ucHVic1tyZXBvc3RQdWJrZXldID0ge1xuICAgICAgICAgIGdyb3VwOiAnb3RoZXInLFxuICAgICAgICAgIGZpcnN0U2VlbjogRGF0ZS5ub3coKSxcbiAgICAgICAgICBsYXN0U2VlbjogRGF0ZS5ub3coKVxuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAga25vd25OcHVicy5ucHVic1tyZXBvc3RQdWJrZXldLmxhc3RTZWVuID0gRGF0ZS5ub3coKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gQWRkIHphcHNcbiAgICBzb2NpYWxHcmFwaC5tZW1iZXJzW3B1YmtleV0uemFwcy5wdXNoKC4uLmludGVyYWN0aW9ucy56YXBzKTtcbiAgfVxuICBcbiAgLy8gU2F2ZSB1cGRhdGVkIGRhdGFcbiAgYXdhaXQgc2F2ZVNvY2lhbEdyYXBoRGF0YShzb2NpYWxHcmFwaCk7XG4gIGF3YWl0IHNhdmVLbm93bk5wdWJzRGF0YShrbm93bk5wdWJzKTtcbiAgXG4gIHJldHVybiB7XG4gICAgc29jaWFsR3JhcGgsXG4gICAga25vd25OcHVic1xuICB9O1xufVxuXG4vLyBDb252ZXJ0IHNvY2lhbCBncmFwaCBkYXRhIHRvIHZpc3VhbGl6YXRpb24gZm9ybWF0XG5mdW5jdGlvbiBzb2NpYWxHcmFwaFRvVmlzR3JhcGgoc29jaWFsR3JhcGg6IFNvY2lhbEdyYXBoRGF0YSwga25vd25OcHViczogS25vd25OcHVic0RhdGEpOiBWaXNHcmFwaCB7XG4gIGNvbnN0IG5vZGVzOiBWaXNOb2RlW10gPSBbXTtcbiAgY29uc3QgbGlua3M6IFZpc0xpbmtbXSA9IFtdO1xuICBjb25zdCBub2RlTWFwID0gbmV3IE1hcDxzdHJpbmcsIGJvb2xlYW4+KCk7XG4gIFxuICAvLyBIZWxwZXIgdG8gZGV0ZXJtaW5lIG5vZGUgdHlwZVxuICBmdW5jdGlvbiBnZXROb2RlVHlwZShwdWJrZXk6IHN0cmluZyk6IE5vZGVUeXBlIHtcbiAgICBjb25zdCBucHViRGF0YSA9IGtub3duTnB1YnMubnB1YnNbcHVia2V5XTtcbiAgICBpZiAoIW5wdWJEYXRhKSByZXR1cm4gTm9kZVR5cGUuRk9MTE9XSU5HO1xuICAgIFxuICAgIGlmIChucHViRGF0YS5ncm91cCA9PT0gJ2ZyZWVNYWRlaXJhJykge1xuICAgICAgcmV0dXJuIE5vZGVUeXBlLkNPUkU7XG4gICAgfVxuICAgIFxuICAgIC8vIENoZWNrIGlmIGl0J3MgbXV0dWFsIHdpdGggYW55IGNvcmUgbWVtYmVyXG4gICAgY29uc3QgbWVtYmVyID0gc29jaWFsR3JhcGgubWVtYmVyc1twdWJrZXldO1xuICAgIGlmICghbWVtYmVyKSByZXR1cm4gTm9kZVR5cGUuRk9MTE9XSU5HO1xuICAgIFxuICAgIGNvbnN0IGNvcmVNZW1iZXJzID0gT2JqZWN0LmVudHJpZXMoa25vd25OcHVicy5ucHVicylcbiAgICAgIC5maWx0ZXIoKFtfLCBkYXRhXSkgPT4gZGF0YS5ncm91cCA9PT0gJ2ZyZWVNYWRlaXJhJylcbiAgICAgIC5tYXAoKFtwdWJrZXldKSA9PiBwdWJrZXkpO1xuICAgIFxuICAgIC8vIENoZWNrIGlmIHRoaXMgcHVia2V5IGZvbGxvd3MgYW55IGNvcmUgbWVtYmVyc1xuICAgIGNvbnN0IGZvbGxvd3NDb3JlID0gbWVtYmVyLmZvbGxvd3Muc29tZShmb2xsb3dlZFB1YmtleSA9PiBjb3JlTWVtYmVycy5pbmNsdWRlcyhmb2xsb3dlZFB1YmtleSkpO1xuICAgIFxuICAgIC8vIENoZWNrIGlmIHRoaXMgcHVia2V5IGlzIGZvbGxvd2VkIGJ5IGFueSBjb3JlIG1lbWJlcnNcbiAgICBjb25zdCBmb2xsb3dlZEJ5Q29yZSA9IG1lbWJlci5mb2xsb3dlcnMuc29tZShmb2xsb3dlclB1YmtleSA9PiBjb3JlTWVtYmVycy5pbmNsdWRlcyhmb2xsb3dlclB1YmtleSkpO1xuICAgIFxuICAgIGlmIChmb2xsb3dzQ29yZSAmJiBmb2xsb3dlZEJ5Q29yZSkge1xuICAgICAgcmV0dXJuIE5vZGVUeXBlLk1VVFVBTDtcbiAgICB9IGVsc2UgaWYgKGZvbGxvd3NDb3JlKSB7XG4gICAgICByZXR1cm4gTm9kZVR5cGUuRk9MTE9XRVI7XG4gICAgfSBlbHNlIGlmIChmb2xsb3dlZEJ5Q29yZSkge1xuICAgICAgcmV0dXJuIE5vZGVUeXBlLkZPTExPV0lORztcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIE5vZGVUeXBlLkZPTExPV0lORztcbiAgfVxuICBcbiAgLy8gQWRkIG5vZGVzIGZvciBlYWNoIG1lbWJlclxuICBPYmplY3Qua2V5cyhzb2NpYWxHcmFwaC5tZW1iZXJzKS5mb3JFYWNoKHB1YmtleSA9PiB7XG4gICAgaWYgKG5vZGVNYXAuaGFzKHB1YmtleSkpIHJldHVybjtcbiAgICBcbiAgICBjb25zdCBtZW1iZXIgPSBzb2NpYWxHcmFwaC5tZW1iZXJzW3B1YmtleV07XG4gICAgbGV0IG5wdWI7XG4gICAgdHJ5IHtcbiAgICAgIG5wdWIgPSBoZXhUb05wdWIocHVia2V5KSB8fCAndW5rbm93bic7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgbnB1YiA9ICd1bmtub3duJztcbiAgICB9XG4gICAgXG4gICAgbm9kZXMucHVzaCh7XG4gICAgICBpZDogcHVia2V5LFxuICAgICAgbmFtZTogbWVtYmVyLm1ldGFkYXRhPy5kaXNwbGF5TmFtZSB8fCBtZW1iZXIubWV0YWRhdGE/Lm5hbWUsXG4gICAgICBucHViLFxuICAgICAgdHlwZTogZ2V0Tm9kZVR5cGUocHVia2V5KSxcbiAgICAgIHBpY3R1cmU6IG1lbWJlci5tZXRhZGF0YT8ucGljdHVyZVxuICAgIH0pO1xuICAgIFxuICAgIG5vZGVNYXAuc2V0KHB1YmtleSwgdHJ1ZSk7XG4gIH0pO1xuICBcbiAgLy8gQWRkIGxpbmtzIGZvciBmb2xsb3dzXG4gIE9iamVjdC5rZXlzKHNvY2lhbEdyYXBoLm1lbWJlcnMpLmZvckVhY2gocHVia2V5ID0+IHtcbiAgICBjb25zdCBtZW1iZXIgPSBzb2NpYWxHcmFwaC5tZW1iZXJzW3B1YmtleV07XG4gICAgXG4gICAgbWVtYmVyLmZvbGxvd3MuZm9yRWFjaCh0YXJnZXRQdWJrZXkgPT4ge1xuICAgICAgLy8gT25seSBhZGQgbGlua3Mgd2hlcmUgYm90aCBub2RlcyBleGlzdFxuICAgICAgaWYgKHNvY2lhbEdyYXBoLm1lbWJlcnNbdGFyZ2V0UHVia2V5XSkge1xuICAgICAgICBsaW5rcy5wdXNoKHtcbiAgICAgICAgICBzb3VyY2U6IHB1YmtleSxcbiAgICAgICAgICB0YXJnZXQ6IHRhcmdldFB1YmtleSxcbiAgICAgICAgICB2YWx1ZTogMSxcbiAgICAgICAgICB0eXBlOiAnZm9sbG93cydcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuICBcbiAgcmV0dXJuIHtcbiAgICBub2RlcyxcbiAgICBsaW5rcyxcbiAgICB0aW1lc3RhbXA6IHNvY2lhbEdyYXBoLmxhc3RVcGRhdGVkXG4gIH07XG59XG5cbi8vIEFQSSB0byBnZXQgc29jaWFsIGdyYXBoIGRhdGEgaW4gdmlzdWFsaXphdGlvbiBmb3JtYXRcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTb2NpYWxHcmFwaERhdGEoKTogUHJvbWlzZTxWaXNHcmFwaD4ge1xuICBhd2FpdCBlbnN1cmVEYXRhRGlyZWN0b3JpZXMoKTtcbiAgY29uc3Qgc29jaWFsR3JhcGggPSBhd2FpdCBsb2FkU29jaWFsR3JhcGhEYXRhKCk7XG4gIGNvbnN0IGtub3duTnB1YnMgPSBhd2FpdCBsb2FkS25vd25OcHVic0RhdGEoKTtcbiAgXG4gIHJldHVybiBzb2NpYWxHcmFwaFRvVmlzR3JhcGgoc29jaWFsR3JhcGgsIGtub3duTnB1YnMpO1xufVxuXG4vLyBBUEkgdG8gZ2V0IHJhdyBzb2NpYWwgZ3JhcGggZGF0YVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFJhd1NvY2lhbEdyYXBoRGF0YSgpOiBQcm9taXNlPFNvY2lhbEdyYXBoRGF0YT4ge1xuICBhd2FpdCBlbnN1cmVEYXRhRGlyZWN0b3JpZXMoKTtcbiAgcmV0dXJuIGF3YWl0IGxvYWRTb2NpYWxHcmFwaERhdGEoKTtcbn1cblxuLy8gQVBJIHRvIGdldCBrbm93biBucHVicyBkYXRhXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0S25vd25OcHVic0RhdGEoKTogUHJvbWlzZTxLbm93bk5wdWJzRGF0YT4ge1xuICBhd2FpdCBlbnN1cmVEYXRhRGlyZWN0b3JpZXMoKTtcbiAgcmV0dXJuIGF3YWl0IGxvYWRLbm93bk5wdWJzRGF0YSgpO1xufVxuXG4vLyBBUEkgdG8gZm9yY2UgdXBkYXRlIHRoZSBzb2NpYWwgZ3JhcGhcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmb3JjZVNvY2lhbEdyYXBoVXBkYXRlKCk6IFByb21pc2U8VmlzR3JhcGg+IHtcbiAgYXdhaXQgdXBkYXRlU29jaWFsR3JhcGgoKTtcbiAgcmV0dXJuIGF3YWl0IGdldFNvY2lhbEdyYXBoRGF0YSgpO1xufVxuXG4vLyBTZXQgdXAgYSBzY2hlZHVsZWQgdXBkYXRlIChjYW4gYmUgY2FsbGVkIGZyb20gYSBOZXh0LmpzIEFQSSByb3V0ZSlcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZXR1cFNjaGVkdWxlZFVwZGF0ZShpbnRlcnZhbEluSG91cnMgPSAyNCkge1xuICAvLyBGaXJzdCB1cGRhdGUgaW1tZWRpYXRlbHlcbiAgYXdhaXQgdXBkYXRlU29jaWFsR3JhcGgoKTtcbiAgXG4gIC8vIFRoZW4gc2NoZWR1bGUgcmVndWxhciB1cGRhdGVzXG4gIHNldEludGVydmFsKGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCB1cGRhdGVTb2NpYWxHcmFwaCgpO1xuICB9LCBpbnRlcnZhbEluSG91cnMgKiA2MCAqIDYwICogMTAwMCk7XG59XG5cbi8vIEV4cG9ydCBpbnRlcmZhY2VzIGZvciB1c2UgaW4gb3RoZXIgY29tcG9uZW50c1xuZXhwb3J0IHR5cGUgeyBTb2NpYWxHcmFwaERhdGEsIEtub3duTnB1YnNEYXRhLCBWaXNHcmFwaCwgVmlzTm9kZSwgVmlzTGluayB9OyBcblxuLy8gRXhwb3J0IHV0aWxpdHkgZnVuY3Rpb25zXG5leHBvcnQgeyBhZGRLbm93bk5wdWIgfTsgIl0sIm5hbWVzIjpbIlNpbXBsZVBvb2wiLCJuaXAxOSIsIndyaXRlRmlsZSIsInJlYWRGaWxlIiwibWtkaXIiLCJwYXRoIiwiTk9TVFJfQ09ORklHIiwiTm9kZVR5cGUiLCJucHViVG9IZXgiLCJucHViIiwic3RhcnRzV2l0aCIsInJlc3VsdCIsImRlY29kZSIsInR5cGUiLCJkYXRhIiwiZXJyb3IiLCJjb25zb2xlIiwiaGV4VG9OcHViIiwiaGV4IiwibnB1YkVuY29kZSIsImVuc3VyZURhdGFEaXJlY3RvcmllcyIsImRpcm5hbWUiLCJzb2NpYWxHcmFwaEZpbGUiLCJyZWN1cnNpdmUiLCJlcnIiLCJpbml0aWFsRGF0YSIsImxhc3RVcGRhdGVkIiwiRGF0ZSIsIm5vdyIsIm1lbWJlcnMiLCJKU09OIiwic3RyaW5naWZ5Iiwia25vd25QdWJrZXlzRmlsZSIsImluaXRpYWxLbm93bk5wdWJzIiwibnB1YnMiLCJncm91cCIsImZpcnN0U2VlbiIsImxhc3RTZWVuIiwibG9hZFNvY2lhbEdyYXBoRGF0YSIsInBhcnNlIiwibG9hZEtub3duTnB1YnNEYXRhIiwic2F2ZVNvY2lhbEdyYXBoRGF0YSIsInNhdmVLbm93bk5wdWJzRGF0YSIsImFkZEtub3duTnB1YiIsImtub3duTnB1YnMiLCJmZXRjaFByb2ZpbGVNZXRhZGF0YSIsInB1YmtleSIsInBvb2wiLCJtZXRhZGF0YSIsIm1ldGFkYXRhUHJvbWlzZSIsIlByb21pc2UiLCJyZXNvbHZlIiwiZm91bmRNZXRhZGF0YSIsInN1YnNjcmlwdGlvbiIsInN1YnNjcmliZU1hbnkiLCJkZWZhdWx0UmVsYXlzIiwia2luZHMiLCJhdXRob3JzIiwibGltaXQiLCJvbmV2ZW50IiwiZXZlbnQiLCJjb250ZW50IiwiZSIsIm9uZW9zZSIsInNldFRpbWVvdXQiLCJjbG9zZSIsImZldGNoVGltZW91dE1zIiwiZmV0Y2hGb2xsb3dzIiwiZm9sbG93cyIsImZvbGxvd3NQcm9taXNlIiwiZm9sbG93ZWRQdWJrZXlzIiwidGFncyIsImZpbHRlciIsInRhZyIsIm1hcCIsInB1c2giLCJmZXRjaEludGVyYWN0aW9ucyIsInNpbmNlIiwiaW50ZXJhY3Rpb25zIiwibWVudGlvbnMiLCJsaWtlcyIsInJlcG9zdHMiLCJ6YXBzIiwiaW50ZXJhY3Rpb25zUHJvbWlzZSIsInVuZGVmaW5lZCIsIm1heEV2ZW50c1BlclJlbGF5Iiwia2luZCIsImFtb3VudFRhZyIsImZpbmQiLCJhbW91bnQiLCJwYXJzZUludCIsImlzTmFOIiwidGFyZ2V0IiwidGltZXN0YW1wIiwiY3JlYXRlZF9hdCIsInVwZGF0ZVNvY2lhbEdyYXBoIiwic29jaWFsR3JhcGgiLCJmcmVlTWFkZWlyYU1lbWJlcnMiLCJPYmplY3QiLCJlbnRyaWVzIiwiXyIsImFnZW5jeVB1YmtleXMiLCJsb2ciLCJmb2xsb3dlcnMiLCJuYW1lIiwiZGlzcGxheU5hbWUiLCJkaXNwbGF5X25hbWUiLCJwaWN0dXJlIiwiYWJvdXQiLCJuaXAwNSIsImZvbGxvd2VkUHVia2V5IiwiaW5jbHVkZXMiLCJmb2xsb3dlZE1ldGFkYXRhIiwib25lV2Vla0FnbyIsIk1hdGgiLCJmbG9vciIsIm1lbnRpb25QdWJrZXkiLCJsaWtlUHVia2V5IiwicmVwb3N0UHVia2V5Iiwic29jaWFsR3JhcGhUb1Zpc0dyYXBoIiwibm9kZXMiLCJsaW5rcyIsIm5vZGVNYXAiLCJNYXAiLCJnZXROb2RlVHlwZSIsIm5wdWJEYXRhIiwiRk9MTE9XSU5HIiwiQ09SRSIsIm1lbWJlciIsImNvcmVNZW1iZXJzIiwiZm9sbG93c0NvcmUiLCJzb21lIiwiZm9sbG93ZWRCeUNvcmUiLCJmb2xsb3dlclB1YmtleSIsIk1VVFVBTCIsIkZPTExPV0VSIiwia2V5cyIsImZvckVhY2giLCJoYXMiLCJpZCIsInNldCIsInRhcmdldFB1YmtleSIsInNvdXJjZSIsInZhbHVlIiwiZ2V0U29jaWFsR3JhcGhEYXRhIiwiZ2V0UmF3U29jaWFsR3JhcGhEYXRhIiwiZ2V0S25vd25OcHVic0RhdGEiLCJmb3JjZVNvY2lhbEdyYXBoVXBkYXRlIiwic2V0dXBTY2hlZHVsZWRVcGRhdGUiLCJpbnRlcnZhbEluSG91cnMiLCJzZXRJbnRlcnZhbCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/nostr/NostrSocialGraphFetcher.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/nostr/config.ts":
/*!*********************************!*\
  !*** ./src/lib/nostr/config.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   InteractionType: () => (/* binding */ InteractionType),\n/* harmony export */   NOSTR_CONFIG: () => (/* binding */ NOSTR_CONFIG),\n/* harmony export */   NodeType: () => (/* binding */ NodeType),\n/* harmony export */   NostrEventKind: () => (/* binding */ NostrEventKind),\n/* harmony export */   VISUALIZATION_CONFIG: () => (/* binding */ VISUALIZATION_CONFIG)\n/* harmony export */ });\n/**\n * Nostr configuration for the social graph fetcher\n */ const NOSTR_CONFIG = {\n    // Default relays to connect to\n    defaultRelays: [\n        'wss://relay.damus.io',\n        'wss://relay.primal.net',\n        'wss://nos.lol',\n        'wss://nostr.wine',\n        'wss://relay.snort.social'\n    ],\n    // Initial set of known npubs (Free Madeira members)\n    // This is just an initial set - more can be added via the API\n    initialKnownNpubs: [\n        // Free Madeira \n        'npub1etgqcj9gc6yaxttuwu9eqgs3ynt2dzaudvwnrssrn2zdt2useaasfj8n6e',\n        // Madtrips agency\n        'npub1dxd02kcjhgpkyrx60qnkd6j42kmc72u5lum0rp2ud8x5zfhnk4zscjj6hh'\n    ],\n    // Timeouts and limits\n    fetchTimeoutMs: 10000,\n    maxEventsPerRelay: 500,\n    // Data file paths (relative to project root)\n    dataPath: './data',\n    socialGraphFile: './data/social-graph.json',\n    knownPubkeysFile: './data/known-pubkeys.json'\n};\n// Social graph node types\nvar NodeType = /*#__PURE__*/ function(NodeType) {\n    NodeType[\"CORE\"] = \"core\";\n    NodeType[\"FOLLOWER\"] = \"follower\";\n    NodeType[\"FOLLOWING\"] = \"following\";\n    NodeType[\"MUTUAL\"] = \"mutual\";\n    return NodeType;\n}({});\n// Interaction types\nvar InteractionType = /*#__PURE__*/ function(InteractionType) {\n    InteractionType[\"FOLLOWS\"] = \"follows\";\n    InteractionType[\"MENTIONED\"] = \"mentioned\";\n    InteractionType[\"REPLIED\"] = \"replied\";\n    InteractionType[\"REPOSTED\"] = \"reposted\";\n    InteractionType[\"LIKED\"] = \"liked\";\n    InteractionType[\"ZAPPED\"] = \"zapped\";\n    return InteractionType;\n}({});\n// Event kinds we're interested in\nvar NostrEventKind = /*#__PURE__*/ function(NostrEventKind) {\n    NostrEventKind[NostrEventKind[\"METADATA\"] = 0] = \"METADATA\";\n    NostrEventKind[NostrEventKind[\"TEXT_NOTE\"] = 1] = \"TEXT_NOTE\";\n    NostrEventKind[NostrEventKind[\"RECOMMEND_RELAY\"] = 2] = \"RECOMMEND_RELAY\";\n    NostrEventKind[NostrEventKind[\"CONTACTS\"] = 3] = \"CONTACTS\";\n    NostrEventKind[NostrEventKind[\"ENCRYPTED_DM\"] = 4] = \"ENCRYPTED_DM\";\n    NostrEventKind[NostrEventKind[\"DELETE\"] = 5] = \"DELETE\";\n    NostrEventKind[NostrEventKind[\"REPOST\"] = 6] = \"REPOST\";\n    NostrEventKind[NostrEventKind[\"REACTION\"] = 7] = \"REACTION\";\n    NostrEventKind[NostrEventKind[\"ZAP\"] = 9735] = \"ZAP\";\n    return NostrEventKind;\n}({});\n// Configuration for the visualization\nconst VISUALIZATION_CONFIG = {\n    coreNodeColor: '#9333EA',\n    followerNodeColor: '#3B82F6',\n    followingNodeColor: '#22C55E',\n    mutualNodeColor: '#F59E0B',\n    defaultNodeSize: 5,\n    coreNodeSize: 10,\n    linkDistance: 100,\n    linkStrength: 0.1\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL25vc3RyL2NvbmZpZy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBOztDQUVDLEdBRU0sTUFBTUEsZUFBZTtJQUMxQiwrQkFBK0I7SUFDL0JDLGVBQWU7UUFDYjtRQUNBO1FBQ0E7UUFDQTtRQUNBO0tBQ0Q7SUFFRCxvREFBb0Q7SUFDcEQsOERBQThEO0lBQzlEQyxtQkFBbUI7UUFDakIsZ0JBQWdCO1FBQ2hCO1FBRUEsa0JBQWtCO1FBQ2xCO0tBQ0Q7SUFFRCxzQkFBc0I7SUFDdEJDLGdCQUFnQjtJQUNoQkMsbUJBQW1CO0lBRW5CLDZDQUE2QztJQUM3Q0MsVUFBVTtJQUNWQyxpQkFBaUI7SUFDakJDLGtCQUFrQjtBQUNwQixFQUFFO0FBRUYsMEJBQTBCO0FBQ25CLHNDQUFLQzs7Ozs7V0FBQUE7TUFLWDtBQUVELG9CQUFvQjtBQUNiLDZDQUFLQzs7Ozs7OztXQUFBQTtNQU9YO0FBRUQsa0NBQWtDO0FBQzNCLDRDQUFLQzs7Ozs7Ozs7OztXQUFBQTtNQVVYO0FBRUQsc0NBQXNDO0FBQy9CLE1BQU1DLHVCQUF1QjtJQUNsQ0MsZUFBZTtJQUNmQyxtQkFBbUI7SUFDbkJDLG9CQUFvQjtJQUNwQkMsaUJBQWlCO0lBQ2pCQyxpQkFBaUI7SUFDakJDLGNBQWM7SUFDZEMsY0FBYztJQUNkQyxjQUFjO0FBQ2hCLEVBQUUiLCJzb3VyY2VzIjpbIi9ob21lL2xmZy9HaXQvTWFkdHJpcHMvc3JjL2xpYi9ub3N0ci9jb25maWcudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBOb3N0ciBjb25maWd1cmF0aW9uIGZvciB0aGUgc29jaWFsIGdyYXBoIGZldGNoZXJcbiAqL1xuXG5leHBvcnQgY29uc3QgTk9TVFJfQ09ORklHID0ge1xuICAvLyBEZWZhdWx0IHJlbGF5cyB0byBjb25uZWN0IHRvXG4gIGRlZmF1bHRSZWxheXM6IFtcbiAgICAnd3NzOi8vcmVsYXkuZGFtdXMuaW8nLFxuICAgICd3c3M6Ly9yZWxheS5wcmltYWwubmV0JyxcbiAgICAnd3NzOi8vbm9zLmxvbCcsXG4gICAgJ3dzczovL25vc3RyLndpbmUnLFxuICAgICd3c3M6Ly9yZWxheS5zbm9ydC5zb2NpYWwnXG4gIF0sXG4gIFxuICAvLyBJbml0aWFsIHNldCBvZiBrbm93biBucHVicyAoRnJlZSBNYWRlaXJhIG1lbWJlcnMpXG4gIC8vIFRoaXMgaXMganVzdCBhbiBpbml0aWFsIHNldCAtIG1vcmUgY2FuIGJlIGFkZGVkIHZpYSB0aGUgQVBJXG4gIGluaXRpYWxLbm93bk5wdWJzOiBbXG4gICAgLy8gRnJlZSBNYWRlaXJhIFxuICAgICducHViMWV0Z3FjajlnYzZ5YXh0dHV3dTllcWdzM3ludDJkemF1ZHZ3bnJzc3JuMnpkdDJ1c2VhYXNmajhuNmUnLFxuICAgIFxuICAgIC8vIE1hZHRyaXBzIGFnZW5jeVxuICAgICducHViMWR4ZDAya2NqaGdwa3lyeDYwcW5rZDZqNDJrbWM3MnU1bHVtMHJwMnVkOHg1emZobms0enNjamo2aGgnLFxuICBdLFxuICBcbiAgLy8gVGltZW91dHMgYW5kIGxpbWl0c1xuICBmZXRjaFRpbWVvdXRNczogMTAwMDAsIC8vIDEwIHNlY29uZHNcbiAgbWF4RXZlbnRzUGVyUmVsYXk6IDUwMCxcbiAgXG4gIC8vIERhdGEgZmlsZSBwYXRocyAocmVsYXRpdmUgdG8gcHJvamVjdCByb290KVxuICBkYXRhUGF0aDogJy4vZGF0YScsXG4gIHNvY2lhbEdyYXBoRmlsZTogJy4vZGF0YS9zb2NpYWwtZ3JhcGguanNvbicsXG4gIGtub3duUHVia2V5c0ZpbGU6ICcuL2RhdGEva25vd24tcHVia2V5cy5qc29uJyxcbn07XG5cbi8vIFNvY2lhbCBncmFwaCBub2RlIHR5cGVzXG5leHBvcnQgZW51bSBOb2RlVHlwZSB7XG4gIENPUkUgPSAnY29yZScsICAgICAgLy8gQ29yZSBGcmVlIE1hZGVpcmEgbWVtYmVyXG4gIEZPTExPV0VSID0gJ2ZvbGxvd2VyJywgIC8vIEZvbGxvd3MgRnJlZSBNYWRlaXJhIG1lbWJlcnNcbiAgRk9MTE9XSU5HID0gJ2ZvbGxvd2luZycsIC8vIEZvbGxvd2VkIGJ5IEZyZWUgTWFkZWlyYSBtZW1iZXJzXG4gIE1VVFVBTCA9ICdtdXR1YWwnLCAgICAvLyBNdXR1YWwgZm9sbG93cyB3aXRoIEZyZWUgTWFkZWlyYSBtZW1iZXJzXG59XG5cbi8vIEludGVyYWN0aW9uIHR5cGVzXG5leHBvcnQgZW51bSBJbnRlcmFjdGlvblR5cGUge1xuICBGT0xMT1dTID0gJ2ZvbGxvd3MnLFxuICBNRU5USU9ORUQgPSAnbWVudGlvbmVkJyxcbiAgUkVQTElFRCA9ICdyZXBsaWVkJyxcbiAgUkVQT1NURUQgPSAncmVwb3N0ZWQnLFxuICBMSUtFRCA9ICdsaWtlZCcsXG4gIFpBUFBFRCA9ICd6YXBwZWQnLFxufVxuXG4vLyBFdmVudCBraW5kcyB3ZSdyZSBpbnRlcmVzdGVkIGluXG5leHBvcnQgZW51bSBOb3N0ckV2ZW50S2luZCB7XG4gIE1FVEFEQVRBID0gMCxcbiAgVEVYVF9OT1RFID0gMSxcbiAgUkVDT01NRU5EX1JFTEFZID0gMixcbiAgQ09OVEFDVFMgPSAzLFxuICBFTkNSWVBURURfRE0gPSA0LFxuICBERUxFVEUgPSA1LFxuICBSRVBPU1QgPSA2LFxuICBSRUFDVElPTiA9IDcsXG4gIFpBUCA9IDk3MzUsXG59XG5cbi8vIENvbmZpZ3VyYXRpb24gZm9yIHRoZSB2aXN1YWxpemF0aW9uXG5leHBvcnQgY29uc3QgVklTVUFMSVpBVElPTl9DT05GSUcgPSB7XG4gIGNvcmVOb2RlQ29sb3I6ICcjOTMzM0VBJywgLy8gUHVycGxlIGZvciBGcmVlIE1hZGVpcmFcbiAgZm9sbG93ZXJOb2RlQ29sb3I6ICcjM0I4MkY2JywgLy8gQmx1ZVxuICBmb2xsb3dpbmdOb2RlQ29sb3I6ICcjMjJDNTVFJywgLy8gR3JlZW5cbiAgbXV0dWFsTm9kZUNvbG9yOiAnI0Y1OUUwQicsIC8vIEFtYmVyXG4gIGRlZmF1bHROb2RlU2l6ZTogNSxcbiAgY29yZU5vZGVTaXplOiAxMCxcbiAgbGlua0Rpc3RhbmNlOiAxMDAsXG4gIGxpbmtTdHJlbmd0aDogMC4xLFxufTsgIl0sIm5hbWVzIjpbIk5PU1RSX0NPTkZJRyIsImRlZmF1bHRSZWxheXMiLCJpbml0aWFsS25vd25OcHVicyIsImZldGNoVGltZW91dE1zIiwibWF4RXZlbnRzUGVyUmVsYXkiLCJkYXRhUGF0aCIsInNvY2lhbEdyYXBoRmlsZSIsImtub3duUHVia2V5c0ZpbGUiLCJOb2RlVHlwZSIsIkludGVyYWN0aW9uVHlwZSIsIk5vc3RyRXZlbnRLaW5kIiwiVklTVUFMSVpBVElPTl9DT05GSUciLCJjb3JlTm9kZUNvbG9yIiwiZm9sbG93ZXJOb2RlQ29sb3IiLCJmb2xsb3dpbmdOb2RlQ29sb3IiLCJtdXR1YWxOb2RlQ29sb3IiLCJkZWZhdWx0Tm9kZVNpemUiLCJjb3JlTm9kZVNpemUiLCJsaW5rRGlzdGFuY2UiLCJsaW5rU3RyZW5ndGgiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/nostr/config.ts\n");

/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("fs");

/***/ }),

/***/ "fs/promises":
/*!******************************!*\
  !*** external "fs/promises" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("fs/promises");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:crypto");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/nostr-tools","vendor-chunks/@noble"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fdiagnosis%2Froute&page=%2Fapi%2Fdiagnosis%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fdiagnosis%2Froute.ts&appDir=%2Fhome%2Flfg%2FGit%2FMadtrips%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Flfg%2FGit%2FMadtrips&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();