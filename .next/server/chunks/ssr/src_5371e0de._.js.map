{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/lfg/Git/Madtrips/src/hooks/useDebounce.ts"],"sourcesContent":["import { useState, useEffect } from 'react'\n\nexport function useDebounce<T>(value: T, delay: number): T {\n  const [debouncedValue, setDebouncedValue] = useState<T>(value)\n\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      setDebouncedValue(value)\n    }, delay)\n\n    return () => {\n      clearTimeout(timer)\n    }\n  }, [value, delay])\n\n  return debouncedValue\n} "],"names":[],"mappings":";;;AAAA;;AAEO,SAAS,YAAe,KAAQ,EAAE,KAAa;IACpD,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAK;IAExD,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,QAAQ,WAAW;YACvB,kBAAkB;QACpB,GAAG;QAEH,OAAO;YACL,aAAa;QACf;IACF,GAAG;QAAC;QAAO;KAAM;IAEjB,OAAO;AACT","debugId":null}},
    {"offset": {"line": 33, "column": 0}, "map": {"version":3,"sources":["file:///home/lfg/Git/Madtrips/src/components/home/BitcoinMap.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect, useState, useMemo, useCallback } from 'react'\nimport Link from 'next/link'\nimport { useDebounce } from '@/hooks/useDebounce'\n\ninterface Business {\n  id: string\n  name: string\n  tags?: string[]\n  lat?: number\n  lon?: number\n}\n\n// Funchal coordinates\nconst FUNCHAL_LAT = 32.6497\nconst FUNCHAL_LON = -16.9082\nconst RADIUS_KM = 30\n\n// API Key - should be moved to environment variable\nconst BTCMAP_API_KEY = process.env.NEXT_PUBLIC_BTCMAP_API_KEY\n\n// Fallback data in case API fails\nconst fallbackBusinesses: Business[] = [\n  {\n    id: '1',\n    name: 'Bitcoin Beach Madeira',\n    tags: ['beach', 'bar', 'restaurant']\n  },\n  {\n    id: '2',\n    name: 'Digital Nomad Hub',\n    tags: ['coworking', 'community']\n  }\n]\n\n// Calculate distance between two points using Haversine formula\nfunction calculateDistance(lat1: number, lon1: number, lat2: number, lon2: number): number {\n  const R = 6371 // Earth's radius in km\n  const dLat = (lat2 - lat1) * Math.PI / 180\n  const dLon = (lon2 - lon1) * Math.PI / 180\n  const a = \n    Math.sin(dLat/2) * Math.sin(dLat/2) +\n    Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * \n    Math.sin(dLon/2) * Math.sin(dLon/2)\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a))\n  return R * c\n}\n\nexport function BitcoinMap() {\n  const [isMounted, setIsMounted] = useState(false)\n  const [businesses, setBusinesses] = useState<Business[]>([])\n  const [loading, setLoading] = useState(true)\n  const [searchQuery, setSearchQuery] = useState('')\n  const [error, setError] = useState<string | null>(null)\n  const debouncedSearchQuery = useDebounce(searchQuery, 300)\n\n  // Memoized fetch function\n  const fetchBusinesses = useCallback(async () => {\n    try {\n      if (!BTCMAP_API_KEY) {\n        throw new Error('BTCMap API key not configured')\n      }\n\n      const controller = new AbortController()\n      const timeoutId = setTimeout(() => controller.abort(), 10000) // 10s timeout\n\n      const response = await fetch('https://api.btcmap.org/v2/venues', {\n        headers: {\n          'Authorization': `Bearer ${BTCMAP_API_KEY}`,\n          'Accept': 'application/json'\n        },\n        signal: controller.signal\n      })\n\n      clearTimeout(timeoutId)\n\n      if (!response.ok) {\n        const errorText = await response.text()\n        console.error('API Response:', errorText)\n        throw new Error(`Failed to fetch venues: ${response.status} - ${errorText}`)\n      }\n      \n      const data = await response.json()\n      \n      // Transform and filter the data\n      const simplifiedData = data\n        .map((business: any) => ({\n          id: business.id,\n          name: business.name,\n          tags: business.tags || [],\n          lat: business.lat,\n          lon: business.lon\n        }))\n        .filter((business: Business) => {\n          if (!business.lat || !business.lon) return false\n          const distance = calculateDistance(\n            FUNCHAL_LAT, \n            FUNCHAL_LON, \n            business.lat, \n            business.lon\n          )\n          return distance <= RADIUS_KM\n        })\n      \n      setBusinesses(simplifiedData)\n      setError(null)\n    } catch (err) {\n      console.error('Error fetching businesses:', err)\n      setError('Failed to load businesses. Please try again later.')\n      setBusinesses(fallbackBusinesses)\n    } finally {\n      setLoading(false)\n    }\n  }, [])\n\n  useEffect(() => {\n    setIsMounted(true)\n    fetchBusinesses()\n  }, [fetchBusinesses])\n\n  // Memoized filtered businesses\n  const filteredBusinesses = useMemo(() => {\n    if (!debouncedSearchQuery) return businesses\n    const query = debouncedSearchQuery.toLowerCase()\n    return businesses.filter(business => \n      business.name.toLowerCase().includes(query) ||\n      business.tags?.some(tag => tag.toLowerCase().includes(query))\n    )\n  }, [businesses, debouncedSearchQuery])\n\n  if (!isMounted) {\n    return (\n      <div className=\"w-full h-[300px] bg-ocean/10 rounded-lg animate-pulse flex items-center justify-center\">\n        <span className=\"text-forest/60\">Loading map...</span>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"space-y-8 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n      {/* Map Widget */}\n      <div className=\"w-full h-[400px] rounded-lg overflow-hidden border border-sand/20 shadow-lg\">\n        <div className=\"w-full h-full bg-ocean/5 flex items-center justify-center\">\n          <div className=\"text-center space-y-2\">\n            <div className=\"text-bitcoin text-2xl\" aria-hidden=\"true\">üó∫Ô∏è</div>\n            <p className=\"text-forest/60\">Interactive map coming soon</p>\n            <Link \n              href=\"https://btcmap.org/community/free-madeira\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"text-sm text-bitcoin hover:text-bitcoin/80 inline-block\"\n            >\n              View on BTCMap.org ‚Üí\n            </Link>\n          </div>\n        </div>\n      </div>\n\n      {/* Search Section */}\n      <section className=\"space-y-4\" aria-labelledby=\"search-heading\">\n        <div className=\"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2\">\n          <h3 id=\"search-heading\" className=\"text-lg font-semibold text-sand\">Search Bitcoin-Accepting Businesses</h3>\n        </div>\n        \n        {/* Search Bar */}\n        <div className=\"relative\">\n          <input\n            type=\"text\"\n            placeholder=\"Search Bitcoin-accepting businesses...\"\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            className=\"w-full px-4 py-2 rounded-lg border border-sand/20 bg-white/5 text-sand placeholder-forest/40 focus:outline-none focus:ring-2 focus:ring-bitcoin/20\"\n            aria-label=\"Search businesses\"\n          />\n        </div>\n\n        {/* Results count and error message */}\n        <div className=\"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2\">\n          <div className=\"text-sm text-forest/60\">\n            Found {filteredBusinesses.length} business{filteredBusinesses.length !== 1 ? 'es' : ''} within {RADIUS_KM}km of Funchal\n          </div>\n          {error && (\n            <div className=\"text-sm text-bitcoin\" role=\"alert\">\n              {error}\n            </div>\n          )}\n        </div>\n      </section>\n    </div>\n  )\n} "],"names":[],"mappings":"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","debugId":null}}]
}