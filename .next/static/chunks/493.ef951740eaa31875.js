"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[493],{6493:(e,t,s)=>{s.r(t),s.d(t,{default:()=>o});var r=s(5155),a=s(2115),n=s(6298);let l=e=>{let{invoice:t,onSuccess:s,onError:l,buttonText:o="Pay with Lightning",className:i="px-4 py-2 bg-yellow-500 hover:bg-yellow-600 text-white rounded-md font-medium flex items-center justify-center"}=e,{user:d,payInvoice:c,canMakePayments:m,loginMethod:x}=(0,n.yX)(),[h,g]=(0,a.useState)(!1),[u,p]=(0,a.useState)(!1),[y,b]=(0,a.useState)(null),j=async()=>{if(!d){b("Please log in to make a payment"),null==l||l(Error("User not logged in"));return}if(!m||!c){b("Payments not supported with current login method (".concat(x,")")),null==l||l(Error("Payment method not supported"));return}g(!0),b(null);try{let e=await c(t);p(!0),null==s||s(e.preimage),console.log("Payment successful!",e)}catch(t){let e=t instanceof Error?t.message:"Unknown payment error";b(e),null==l||l(t instanceof Error?t:Error(e)),console.error("Payment failed:",t)}finally{g(!1)}};return(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("button",{onClick:j,disabled:h||u||!m||!d,className:"".concat(i," ").concat(h?"opacity-70 cursor-wait":""," \n                  ").concat(u?"bg-green-500 hover:bg-green-500":""," \n                  ").concat(m&&d?"":"opacity-50 cursor-not-allowed"),children:h?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):u?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{className:"-ml-1 mr-2 h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Payment Successful"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{className:"-ml-1 mr-2 h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M11 3a1 1 0 10-2 0v1a1 1 0 102 0V3zM15.657 5.757a1 1 0 00-1.414-1.414l-.707.707a1 1 0 001.414 1.414l.707-.707zM18 10a1 1 0 01-1 1h-1a1 1 0 110-2h1a1 1 0 011 1zM5.05 6.464A1 1 0 106.464 5.05l-.707-.707a1 1 0 00-1.414 1.414l.707.707zM5 10a1 1 0 01-1 1H3a1 1 0 110-2h1a1 1 0 011 1zM8 16v-1h4v1a2 2 0 11-4 0zM12 14c.015-.34.208-.646.477-.859a4 4 0 10-4.954 0c.27.213.462.519.476.859h4.002z"})}),o]})}),y&&(0,r.jsx)("div",{className:"mt-2 text-sm text-red-600 text-center",children:y}),!d&&(0,r.jsx)("div",{className:"mt-2 text-sm text-amber-600 dark:text-amber-400 text-center",children:"Please log in to make a payment"}),d&&!m&&(0,r.jsx)("div",{className:"mt-2 text-sm text-amber-600 dark:text-amber-400 text-center",children:"Your current login method does not support payments. Try using NIP-47 (remote signer)."})]})};function o(){var e,t;let{user:s,loading:o,loginMethod:i,canMakePayments:d}=(0,n.yX)(),[c,m]=(0,a.useState)(""),[x,h]=(0,a.useState)(null),[g,u]=(0,a.useState)(null);return(0,r.jsxs)("div",{className:"max-w-3xl mx-auto p-6",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Nostr Payment Integration Test"}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Connection Status"}),o?(0,r.jsx)("p",{className:"text-gray-500",children:"Loading..."}):s?(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("p",{className:"text-green-500 font-medium",children:["âœ… Connected as: ",(null===(e=s.profile)||void 0===e?void 0:e.displayName)||(null===(t=s.profile)||void 0===t?void 0:t.name)||s.npub]}),(0,r.jsxs)("p",{className:"text-gray-600 dark:text-gray-400",children:["Login Method: ",(0,r.jsx)("span",{className:"font-medium",children:i})]}),(0,r.jsxs)("p",{className:"text-gray-600 dark:text-gray-400",children:["Payment Capable:",(0,r.jsx)("span",{className:"font-medium ".concat(d?"text-green-500":"text-red-500"),children:d?" Yes":" No"})]})]}):(0,r.jsx)("p",{className:"text-amber-500",children:"Not connected. Please log in using the Nostr login button."})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Lightning Payment Test"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"invoice",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Lightning Invoice (BOLT11)"}),(0,r.jsx)("input",{type:"text",id:"invoice",value:c,onChange:e=>{m(e.target.value)},placeholder:"lnbc...",className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-700 rounded-md focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Enter a Lightning invoice to test the payment process."})]}),(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)(l,{invoice:c,onSuccess:e=>{h("Payment successful! Preimage: ".concat(e)),u(null)},onError:e=>{u("Payment failed: ".concat(e.message)),h(null)},buttonText:"Pay Lightning Invoice"})}),x&&(0,r.jsx)("div",{className:"mt-4 p-3 bg-green-100 dark:bg-green-900 border border-green-200 dark:border-green-800 rounded-md text-green-800 dark:text-green-200",children:x}),g&&(0,r.jsx)("div",{className:"mt-4 p-3 bg-red-100 dark:bg-red-900 border border-red-200 dark:border-red-800 rounded-md text-red-800 dark:text-red-200",children:g})]})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Integration Notes"}),(0,r.jsxs)("div",{className:"space-y-3 text-gray-700 dark:text-gray-300",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"NIP-07 Extension Users:"})," Most browser extensions like Alby or nos2x don't directly support the payment method, so you'll need to use a NIP-47 signer."]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"NIP-47 Signers:"})," To test payments, you need a remote signer that supports the",(0,r.jsx)("code",{className:"px-1 bg-gray-100 dark:bg-gray-700 rounded",children:"pay_invoice"})," method."]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"View-Only Mode:"})," Payment functionality is disabled in view-only mode."]}),(0,r.jsxs)("p",{className:"font-medium",children:["This implementation follows the ",(0,r.jsx)("a",{href:"https://github.com/nostr-protocol/nips/blob/master/47.md",className:"text-blue-500 hover:underline",target:"_blank",rel:"noopener noreferrer",children:"NIP-47 specification"}),"and is compatible with wallets that support the Nostr Wallet Connect protocol."]})]})]})]})}}}]);
//# sourceMappingURL=493.ef951740eaa31875.js.map