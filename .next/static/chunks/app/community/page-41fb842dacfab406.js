(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[28],{255:(e,t,r)=>{"use strict";function n(e){let{moduleIds:t}=e;return null}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return n}}),r(5155),r(7650),r(5744),r(589)},2146:(e,t,r)=>{"use strict";function n(e){let{reason:t,children:r}=e;return r}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return n}}),r(5262)},3265:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>j});var n=r(5155),a=r(2115),l=r(6874),s=r.n(l),o=r(5028),i=r(6298);let d=e=>{e.npub&&window.open("https://njump.me/".concat(e.npub),"_blank")},c={bitcoinOrange:"#F7931A",deepBlue:"#1E3A8A",forestGreen:"#0F4C35",lightSand:"#F5E3C3"},u="https://nostr.build/i/nostr.build_d421c1d7fd21c5d73c3428f0fc5ed7359cedb81bcad8074de350bec2d02e9a67.jpeg",h=e=>e?"".concat(e.substring(0,6),"...").concat(e.substring(e.length-4)):"",m=(0,o.default)(()=>r.e(748).then(r.bind(r,9748)).then(e=>e.default),{loadableGenerated:{webpack:()=>[9748]},ssr:!1}),f=["npub1etgqcj9gc6yaxttuwu9eqgs3ynt2dzaudvwnrssrn2zdt2useaasfj8n6e","npub1s0veng2gvfwr62acrxhnqexq76sj6ldg3a5t935jy8e6w3shr5vsnwrmq5","npub1dxd02kcjhgpkyrx60qnkd6j42kmc72u5lum0rp2ud8x5zfhnk4zscjj6hh","npub1funchalx8v747rsee6ahsuyrcd2s3rnxlyrtumfex9lecpmgwars6hq8kc"],g=e=>({nodes:e.nodes.map(e=>({...e,val:e.val||(e.isCoreNode?15:5),color:e.color||(e.isCoreNode?c.bitcoinOrange:c.lightSand)})),links:e.links.map(e=>{var t,r;return{source:"string"==typeof e.source?e.source:(null===(t=e.source)||void 0===t?void 0:t.id)||"",target:"string"==typeof e.target?e.target:(null===(r=e.target)||void 0===r?void 0:r.id)||"",value:e.value||1,color:e.color||("mutual"===e.type?c.bitcoinOrange:c.lightSand+"99")}})}),b=["Fetching relays… or maybe just relaying nonsense.","Decrypting private messages… hope they're not just memes!","Relay lag detected! Blame the plebs.","Loading… because decentralized things take time.","Verifying pubkeys… definitely not reading your DMs.","Fetching Nostr notes… please hold, the relays are gossiping.","Buffering Nostr… because even freedom takes a second to load.","Rounding up relays… they're herding notes like digital catz."],p=e=>{let{centerNpub:t=f[0],npubs:r=f,maxConnections:l=25,height:s=600,width:o="100%",className:p="",data:x}=e,[y,v]=(0,a.useState)(null),[j,w]=(0,a.useState)(null),[N,k]=(0,a.useState)(new Map),[S,P]=(0,a.useState)(!1),[_,E]=(0,a.useState)(!1),[O,C]=(0,a.useState)(null),{ndk:M,user:z,getSocialGraph:A}=(0,i.yX)(),B=(0,a.useRef)(null),[q,I]=(0,a.useState)({width:800,height:600}),[L,T]=(0,a.useState)(0),F=null!==z&&!!z;(0,a.useEffect)(()=>{let e;return _&&(e=setInterval(()=>{T(e=>(e+1)%b.length)},6e3)),()=>{e&&clearInterval(e)}},[_]);let R=async()=>{if(!M){console.log("NDK not initialized - showing connection prompt"),C("Nostr client not initialized. Please connect using a Nostr extension."),E(!1);return}E(!0),C(null);try{let e=r.filter(e=>"string"==typeof e&&e.startsWith("npub1")&&e.length>=60);if(0===e.length){console.error("No valid NPUBs found in:",r),C("No valid NPUBs provided to fetch social graph data. Please check your configuration."),E(!1);return}console.log("Fetching Nostr social graph data for NPUBs:",e);try{let t=await A(e,l);if(console.log("Raw graph data received:",JSON.stringify(t,null,2).substring(0,500)+"..."),!t)throw Error("No data returned from getSocialGraph. Please try again later.");if(!Array.isArray(t.nodes))throw Error("Invalid nodes data - not an array. Please try again later.");if(!Array.isArray(t.links))throw Error("Invalid links data - not an array. Please try again later.");if(t.nodes.forEach((e,t)=>{e.id||console.warn("Node at index ".concat(t," missing id:"),e),e.npub||console.warn("Node at index ".concat(t," missing npub:"),e)}),t&&t.nodes&&t.nodes.length>0)console.log("Successfully fetched social graph with ".concat(t.nodes.length," nodes and ").concat(t.links.length," links")),console.log("Sample node:",t.nodes[0]),v(t);else throw Error("Received empty or invalid graph data from Nostr. Please try again later.")}catch(e){throw console.error("Error in getSocialGraph:",e),e}}catch(t){let e=t instanceof Error?t.message:String(t);console.error("Error fetching social graph data:",e),C("Failed to fetch social graph: ".concat(e))}finally{E(!1)}};return((0,a.useEffect)(()=>{let e=()=>{B.current&&I({width:B.current.offsetWidth,height:B.current.offsetHeight||600})};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,a.useEffect)(()=>{R()},[F,null==z?void 0:z.npub]),(0,a.useEffect)(()=>{(async()=>{if(x){console.log("Using provided data:",x),v(x);return}await R()})()},[M,r.join(","),t,l]),(0,a.useEffect)(()=>{if(null==y?void 0:y.nodes)try{P(!0);let e=new Map,t=()=>{console.log("All images loaded or handled"),k(t=>{let r=new Map(t);return e.forEach((e,t)=>{r.set(t,e)}),r}),P(!1)};(r=>{let n=0,a=r.filter(e=>e&&e.picture&&e.npub&&"string"==typeof e.picture&&"string"==typeof e.npub),l=a.length;if(0===l){t();return}a.forEach(r=>{if(N.has(r.npub)){++n===l&&t();return}let a=new Image;a.crossOrigin="anonymous",a.onload=()=>{e.set(r.npub,a),++n===l&&t()},a.onerror=()=>{let a=new Image;a.crossOrigin="anonymous",a.src=u,a.onload=()=>{e.set(r.npub,a),++n===l&&t()},a.onerror=()=>{++n===l&&t()}};let s=setTimeout(()=>{a.complete||(a.src="",++n===l&&t())},5e3);try{a.src=r.picture}catch(e){clearTimeout(s),++n===l&&t()}})})(y.nodes)}catch(e){console.error("Error in image preloading:",e),P(!1)}},[y]),_)?(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center bg-forest rounded-lg ".concat(p),style:{height:s,width:o},children:[(0,n.jsx)("div",{className:"text-lg font-medium text-center text-sand",children:"Loading Nostr social graph..."}),(0,n.jsx)("div",{className:"mt-4 text-center max-w-md px-4 h-16 flex items-center justify-center",children:(0,n.jsx)("div",{className:"animate-fade-in-out text-lg font-medium text-bitcoin",children:b[L]},L)}),(0,n.jsx)("div",{className:"mt-6 w-64 h-3 bg-sand dark:bg-sand/30 rounded-full overflow-hidden relative shadow-inner",children:(0,n.jsx)("div",{className:"absolute h-full rounded-full animate-fill-empty-bar",style:{background:"linear-gradient(to right, \n                ".concat(c.bitcoinOrange,", \n                ").concat(c.deepBlue,")"),boxShadow:"0 0 10px rgba(247, 147, 26, 0.5)"}})}),(0,n.jsx)("div",{className:"mt-6 text-sm text-sand italic",children:"Real-time data takes a moment to load"})]}):O&&!y?(0,n.jsx)("div",{className:"flex flex-col items-center justify-center ".concat(p),style:{height:s,width:o},children:(0,n.jsxs)("div",{className:"text-center p-6 bg-red-50 dark:bg-red-950 rounded-lg border border-red-200 dark:border-red-800 max-w-md",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-red-700 dark:text-red-400 mb-2",children:"Error Loading Social Graph"}),(0,n.jsx)("p",{className:"text-red-600 dark:text-red-300 mb-4",children:O}),(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsx)("button",{onClick:R,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md shadow-sm transition-colors",children:"Try Again"})}),!M&&(0,n.jsxs)("div",{className:"p-4 mt-4 bg-amber-50 dark:bg-amber-950 rounded-lg border border-amber-200 dark:border-amber-800",children:[(0,n.jsx)("p",{className:"text-amber-700 dark:text-amber-300 mb-2",children:"To use the social graph, you need a Nostr extension. Try installing one of these:"}),(0,n.jsxs)("ul",{className:"list-disc list-inside text-amber-600 dark:text-amber-400",children:[(0,n.jsx)("li",{children:(0,n.jsx)("a",{href:"https://getalby.com/",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-amber-800 dark:hover:text-amber-200",children:"Alby"})}),(0,n.jsx)("li",{children:(0,n.jsx)("a",{href:"https://github.com/fiatjaf/nos2x",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-amber-800 dark:hover:text-amber-200",children:"nos2x"})}),(0,n.jsx)("li",{children:(0,n.jsx)("a",{href:"https://getflamingo.org/",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-amber-800 dark:hover:text-amber-200",children:"Flamingo"})})]})]}),(0,n.jsxs)("div",{className:"mt-4 text-sm text-gray-600 dark:text-gray-400",children:[(0,n.jsx)("p",{children:"We prioritize showing real-time data from the Nostr network rather than using static or mock data."}),(0,n.jsx)("p",{className:"mt-1",children:"This ensures you always see the most up-to-date social connections."})]})]})}):(0,n.jsx)("div",{ref:B,className:"social-graph-container rounded-lg shadow-lg overflow-hidden w-full h-full",style:{height:"number"==typeof s?"".concat(s,"px"):s,width:"number"==typeof o?"".concat(o,"px"):o,background:"linear-gradient(135deg, ".concat(c.deepBlue," 0%, ").concat(c.forestGreen," 100%)")},children:(0,n.jsxs)("div",{className:"w-full h-full relative",children:[(0,n.jsxs)("div",{className:"absolute top-0 left-0 z-10 p-2 flex items-center space-x-2",children:[(0,n.jsx)("div",{className:"font-medium px-3 py-1 bg-white/30 border border-gray-200 rounded shadow-sm text-sm",style:{color:c.lightSand},children:"Bitcoin Madeira Social Graph"}),(0,n.jsxs)("button",{onClick:R,disabled:_,className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded shadow-sm text-sm font-medium border border-gray-200 flex items-center ".concat(_?"opacity-50":""),"aria-label":"Reload graph",style:{color:c.lightSand},children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1 ".concat(_?"animate-spin":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),_?"Loading...":"Reload"]})]}),O&&(0,n.jsx)("div",{className:"absolute top-12 left-0 z-10 p-2 w-full",children:(0,n.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded max-w-md mx-auto",children:[(0,n.jsx)("p",{className:"text-sm",children:O}),(0,n.jsx)("div",{className:"flex justify-end mt-1",children:(0,n.jsx)("button",{onClick:()=>C(null),className:"text-xs text-red-600 hover:text-red-800",children:"Dismiss"})})]})}),j&&(0,n.jsx)("div",{className:"absolute bottom-0 left-0 z-10 p-2 w-full",children:(0,n.jsxs)("div",{className:"shadow-sm p-3 max-w-xs mx-auto border border-gray-200 rounded-lg",style:{backgroundColor:c.deepBlue},children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"w-10 h-10 rounded-full overflow-hidden mr-3 border-2",style:{borderColor:c.bitcoinOrange},children:(0,n.jsx)("img",{src:j.picture||u,alt:j.name||h(j.npub),className:"w-full h-full object-cover",onError:e=>{e.target.src=u}})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"font-medium",style:{color:c.lightSand},children:j.name||h(j.npub)}),(0,n.jsx)("div",{className:"text-xs",style:{color:c.lightSand+"99"},children:h(j.npub)})]})]}),(0,n.jsx)("div",{className:"mt-2 flex justify-end",children:(0,n.jsx)("a",{href:"https://njump.me/".concat(j.npub),target:"_blank",rel:"noopener noreferrer",className:"text-xs hover:underline",style:{color:c.bitcoinOrange},children:"View on Nostr →"})})]})}),(0,n.jsx)("div",{className:"w-full h-full",children:y&&(0,n.jsx)(m,{graphData:g(y),nodeColor:e=>e.color||c.lightSand,nodeVal:e=>e.val||1,linkColor:e=>e.color||c.lightSand+"99",linkWidth:e=>1.5*Math.sqrt(e.value||1),onNodeClick:(e,t)=>{w(e),d(e)},width:q.width,height:q.height,nodeCanvasObject:(e,t,r)=>{let n=(e,t,r)=>{try{t.beginPath(),t.fillStyle=e.color||c.lightSand,t.arc(e.x,e.y,r,0,2*Math.PI),t.fill(),e.isCoreNode&&(t.beginPath(),t.strokeStyle=c.bitcoinOrange,t.lineWidth=2,t.arc(e.x,e.y,r+2,0,2*Math.PI),t.stroke())}catch(e){console.error("Error drawing fallback circle:",e)}};try{let r=e.val||5,a=e.npub||"",l=a?N.get(a):null;if(l&&l.complete&&l.naturalWidth>0)try{t.save(),t.beginPath(),t.arc(e.x,e.y,r,0,2*Math.PI),t.clip();let n=2*r;t.drawImage(l,e.x-r,e.y-r,n,n),t.restore(),e.isCoreNode&&(t.beginPath(),t.strokeStyle=c.bitcoinOrange,t.lineWidth=2,t.arc(e.x,e.y,r+2,0,2*Math.PI),t.stroke())}catch(a){n(e,t,r)}else n(e,t,r)}catch(e){console.error("Error rendering node:",e)}}})})]})})};var x=r(6766);function y(e){let{npub:t,width:r=64,height:l=64,className:s="",alt:o="Nostr Profile"}=e,[d,c]=(0,a.useState)(null),[u,h]=(0,a.useState)(!0),[m,f]=(0,a.useState)(null),{ndk:g,getUserProfile:b}=(0,i.yX)();return(0,a.useEffect)(()=>{(async()=>{if(!g||!t){h(!1);return}h(!0),f(null);try{var e;let r=await b(t);r&&(null===(e=r.profile)||void 0===e?void 0:e.picture)?c(r.profile.picture):c("/assets/bitcoin.png")}catch(e){console.error("Failed to fetch profile for ".concat(t,":"),e),f("Failed to load profile"),c("/assets/bitcoin.png")}finally{h(!1)}})()},[g,t,b]),(0,n.jsx)("div",{className:"relative ".concat(s),children:u?(0,n.jsx)("div",{className:"animate-pulse bg-gray-300 dark:bg-gray-700 rounded-full",style:{width:r,height:l}}):(0,n.jsx)("div",{className:"rounded-full overflow-hidden",style:{width:r,height:l},children:(0,n.jsx)(x.default,{src:d||"/assets/bitcoin.png",alt:o,width:r,height:l,className:"object-cover w-full h-full",priority:!0,unoptimized:!0})})})}let v=e=>"https://njump.me/".concat(e);function j(){let e=[{npub:"npub1etgqcj9gc6yaxttuwu9eqgs3ynt2dzaudvwnrssrn2zdt2useaasfj8n6e",description:"Madeira Community focused on Bitcoin adoption and education."},{npub:"npub1s0veng2gvfwr62acrxhnqexq76sj6ldg3a5t935jy8e6w3shr5vsnwrmq5",description:"The Sovereign Individual"},{npub:"npub1dxd02kcjhgpkyrx60qnkd6j42kmc72u5lum0rp2ud8x5zfhnk4zscjj6hh",description:"Pleb Travel Solutions."},{npub:"npub1funchalx8v747rsee6ahsuyrcd2s3rnxlyrtumfex9lecpmgwars6hq8kc",description:"Descentralized Community Ads Madeira"}],[t,r]=(0,a.useState)({}),{getUserProfile:l}=(0,i.yX)();return(0,a.useEffect)(()=>{(async()=>{let t={};for(let r of e)try{var n;let e=await l(r.npub);e&&(null===(n=e.profile)||void 0===n?void 0:n.name)&&(t[r.npub]=e.profile.displayName||e.profile.name)}catch(e){console.error("Failed to fetch name for ".concat(r.npub,":"),e)}r(t)})()},[l]),(0,n.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold mb-6",children:(0,n.jsx)("span",{className:"text-bitcoin",children:"Bitcoin Madeira Community"})}),(0,n.jsxs)("div",{className:"bg-forest text-white rounded-lg shadow-md p-4 mb-8",children:[(0,n.jsx)("h3",{className:"text-xl font-semibold mb-4 text-sand",children:"This visualization shows the connections between key community members"}),(0,n.jsx)("div",{className:"h-[600px] w-full mb-6",children:(0,n.jsx)(p,{height:600,className:"rounded-lg border border-gray-200"})}),(0,n.jsx)("p",{className:"mb-6",children:"The Bitcoin Madeira community is a network of individuals, businesses, and organizations committed to promoting Bitcoin adoption and education in Madeira."}),(0,n.jsx)("h2",{className:"text-2xl font-bold mb-4 text-sand",children:"Community Members"}),(0,n.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-4",children:e.map(e=>(0,n.jsx)(s(),{href:v(e.npub),target:"_blank",rel:"noopener noreferrer",className:"block transition-transform hover:scale-105 focus:scale-105 hover:shadow-lg focus:shadow-lg outline-none",children:(0,n.jsxs)("div",{className:"bg-white/10 rounded-lg p-5 flex flex-col items-center h-full border border-transparent hover:border-bitcoin focus:border-bitcoin transition-all duration-300",style:{minHeight:"220px"},children:[(0,n.jsx)(y,{npub:e.npub,width:80,height:80,className:"mb-4",alt:t[e.npub]||"Community Member"}),(0,n.jsx)("h3",{className:"text-lg font-semibold text-bitcoin mb-3",children:t[e.npub]||"Loading..."}),(0,n.jsx)("p",{className:"text-center text-sm text-sand",children:e.description})]})},e.npub))})]})]})}},4054:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{bindSnapshot:function(){return s},createAsyncLocalStorage:function(){return l},createSnapshot:function(){return o}});let r=Object.defineProperty(Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available"),"__NEXT_ERROR_CODE",{value:"E504",enumerable:!1,configurable:!0});class n{disable(){throw r}getStore(){}run(){throw r}exit(){throw r}enterWith(){throw r}static bind(e){return e}}let a="undefined"!=typeof globalThis&&globalThis.AsyncLocalStorage;function l(){return a?new a:new n}function s(e){return a?a.bind(e):n.bind(e)}function o(){return a?a.snapshot():function(e,...t){return e(...t)}}},5028:(e,t,r)=>{"use strict";r.d(t,{default:()=>a.a});var n=r(6645),a=r.n(n)},5744:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorage",{enumerable:!0,get:function(){return n.workAsyncStorageInstance}});let n=r(7828)},6645:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a}});let n=r(8229)._(r(7357));function a(e,t){var r;let a={};"function"==typeof e&&(a.loader=e);let l={...a,...t};return(0,n.default)({...l,modules:null==(r=l.loadableGenerated)?void 0:r.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},7357:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i}});let n=r(5155),a=r(2115),l=r(2146);function s(e){return{default:e&&"default"in e?e.default:e}}r(255);let o={loader:()=>Promise.resolve(s(()=>null)),loading:null,ssr:!0},i=function(e){let t={...o,...e},r=(0,a.lazy)(()=>t.loader().then(s)),i=t.loading;function d(e){let s=i?(0,n.jsx)(i,{isLoading:!0,pastDelay:!0,error:null}):null,o=!t.ssr||!!t.loading,d=o?a.Suspense:a.Fragment,c=t.ssr?(0,n.jsxs)(n.Fragment,{children:[null,(0,n.jsx)(r,{...e})]}):(0,n.jsx)(l.BailoutToCSR,{reason:"next/dynamic",children:(0,n.jsx)(r,{...e})});return(0,n.jsx)(d,{...o?{fallback:s}:{},children:c})}return d.displayName="LoadableComponent",d}},7828:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorageInstance",{enumerable:!0,get:function(){return n}});let n=(0,r(4054).createAsyncLocalStorage)()},8442:(e,t,r)=>{Promise.resolve().then(r.bind(r,3265))}},e=>{var t=t=>e(e.s=t);e.O(0,[475,874,624,766,298,441,684,358],()=>t(8442)),_N_E=e.O()}]);
//# sourceMappingURL=page-41fb842dacfab406.js.map